<!doctype html>
<html lang="pl">
<head>
  <!-- BoliHelp • Strona główna • v2.2 (badges + leaderboard + konfetti + reset) -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Boli Help — Strona główna</title>
  <meta name="theme-color" content="#0e1230" />

  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="assets/style.css?v=10" />

  <style>
    html,body{height:100%}
    body[data-page="home"]{
      position:relative;
      background:#0e1230 !important;
      color:#eef2ff;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    body[data-page="home"]::before,
    body[data-page="home"]::after,
    body[data-page="home"] .container::before,
    body[data-page="home"] .container::after{content:none !important;display:none !important}

    .bh-wallpaper,.bh-grid{position:fixed;inset:0;pointer-events:none}
    .bh-wallpaper{
      z-index:0;
      background:
        radial-gradient(42vw 36vh at 16% 12%, rgba(255,110,199,.30), transparent 60%),
        radial-gradient(36vw 30vh at 84% 10%, rgba(94,234,212,.22), transparent 60%),
        radial-gradient(40vw 44vh at 20% 88%, rgba(164,107,255,.16), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0));
      filter: blur(10px) saturate(118%);
    }
    .bh-grid{
      z-index:1; opacity:.22;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='104' viewBox='0 0 120 104'%3E%3Cg fill='none' stroke='rgba(173,216,255,0.26)' stroke-width='1'%3E%3Cpolygon points='30,0 90,0 120,52 90,104 30,104 0,52'/%3E%3C/g%3E%3C/svg%3E");
      background-size:160px 138px; background-position:center;
    }
    .bh-floor-fade{
      position:fixed; left:0; right:0; bottom:0; height:120px; z-index:2; pointer-events:none;
      background:linear-gradient(180deg, rgba(14,18,48,0), rgba(14,18,48,.35) 55%, rgba(14,18,48,.6));
    }
    .container{position:relative;z-index:3;background:transparent !important;max-width:1100px;margin:0 auto;padding:0 16px}

    @media (min-width:981px){
      section.stack[style]{grid-template-columns:repeat(3,1fr) !important;}
    }
    @media (max-width:980px){
      section.stack[style]{grid-template-columns:repeat(2,1fr) !important;}
    }
    @media (max-width:640px){
      section.stack[style]{grid-template-columns:1fr !important;}
    }
    section.stack[style] > *{grid-column:auto !important;min-width:0 !important}

    .card{border-radius:18px;overflow:hidden;background:rgba(60,32,100,.32);border:1px solid rgba(164,107,255,.22);box-shadow:0 10px 22px rgba(255,110,199,.12), 0 0 0 1px rgba(164,107,255,.14) inset;min-height:240px}
    .card a{display:grid;grid-template-rows:minmax(180px,240px) auto;height:100%;text-decoration:none;color:inherit}
    .card img{width:100%;height:100%;object-fit:contain;object-position:center;background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02))}
    .card .caption{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:12px 14px;border-top:1px solid rgba(164,107,255,.22);background:rgba(255,255,255,.04)}

    /* Leaderboard + konfetti + reset */
    .bh2025-leader{
      margin:8px 0 12px; padding:12px 14px; border-radius:14px;
      background:rgba(60,32,100,.28);
      border:1px solid rgba(164,107,255,.22);
      backdrop-filter: blur(6px) saturate(118%);
      box-shadow: 0 6px 16px rgba(8,10,22,.35), inset 0 0 0 1px rgba(164,107,255,.14);
      color:#eef2ff;
    }
    .bh2025-leader h3{margin:0 0 8px; font-size:16px; letter-spacing:.2px}
    .bh2025-leader ol{margin:0; padding-left:20px;}
    .bh2025-leader li{margin:4px 0; line-height:1.4; color:#d6dfff;}
    .bh2025-leader time{ color:#b8c2e0; font-size:12px; margin-left:6px }
    .bh2025-leader .score{ font-weight:800 }
    .bh2025-reset{
      margin-top:10px; display:flex; gap:8px; align-items:center; justify-content:flex-start;
    }
    .bh2025-reset button{
      appearance:none; border-radius:12px; padding:8px 12px; font-weight:800; letter-spacing:.2px; cursor:pointer;
      color:#0a0d22; background:#ffd16c; border:1px solid rgba(0,0,0,.15);
      box-shadow:0 6px 16px rgba(8,10,22,.25), 0 0 0 1px rgba(255,255,255,.08) inset;
      transition: transform .15s ease, box-shadow .15s ease;
    }
    .bh2025-reset button:hover{ transform:translateY(-1px); box-shadow:0 10px 20px rgba(8,10,22,.35), 0 0 0 1px rgba(255,255,255,.12) inset; }
    .bh2025-reset small{ color:#b8c2e0 }

    /* Odznaki */
    #bh2025-badgebox{
      margin:12px 0 16px; padding:12px 14px; border-radius:14px;
      background:rgba(60,32,100,.28); border:1px solid rgba(164,107,255,.22);
      box-shadow: 0 6px 16px rgba(8,10,22,.35), inset 0 0 0 1px rgba(164,107,255,.14);
    }
    #bh2025-badgelist span{ display:inline-block; margin:0 6px 6px 0; padding:6px 8px; border-radius:999px;
      background:rgba(255,255,255,.06); border:1px solid rgba(164,107,255,.24) }
    #bh2025-confetti{
      position:fixed; inset:0; pointer-events:none; z-index:9999; display:none;
    }
  </style>
</head>
<body data-page="home">
  <div class="bh-wallpaper" aria-hidden="true"></div>
  <div class="bh-grid" aria-hidden="true"></div>
  <div class="bh-floor-fade" aria-hidden="true"></div>

  <div class="container">
    <header class="header">
      <div class="brand">
        <h1>Boli Help</h1>
        <small>Pomoc i pierwsza pomoc w nagłych sytuacjach</small>
      </div>
      <div class="tools">
        <div class="search" role="search">
          <input type="search" placeholder="Szukaj objawu, części ciała lub tematu…" aria-label="Szukaj" />
        </div>
      </div>
    </header>

    <div class="emergency-list">
      <a href="tel:112">📞 112</a><a href="tel:999">🚑 999</a><a href="tel:998">🔥 998</a><a href="tel:997">👮 997</a>
    </div>

    <nav class="situations">
      <a class="pill pill--green" href="szczegoly.html?typ=porada&czesc=zadlawienie&label=Zadławienie">🫁 Zadławienie</a>
      <a class="pill pill--green" href="szczegoly.html?typ=porada&czesc=reanimacja&label=Reanimacja">🚑 Reanimacja</a>
      <a class="pill pill--green" href="szczegoly.html?typ=porada&czesc=wypadek&label=Wypadek">💥 Wypadek</a>
      <a class="pill pill--green" href="szczegoly.html?typ=porada&czesc=pierwszopomoc&label=Pierwsza%20pomoc">❤️‍🩹 Pierwsza pomoc</a>
    </nav>

    <!-- Odznaki -->
    <section id="bh2025-badgebox" hidden aria-label="Twoje odznaki">
      <h3>Twoje odznaki</h3>
      <div id="bh2025-badgelist"></div>
      <div id="bh2025-badgenote" style="margin-top:6px;color:#b8c2e0"></div>
    </section>

    <!-- Leaderboard + RESET -->
    <div class="bh2025-leader" aria-label="Ranking najlepszych wyników">
      <h3>Top 5 wyników</h3>
      <ol id="bh2025-leaderlist"></ol>
      <div class="bh2025-reset">
        <button id="bh2025-reset-btn" type="button" aria-label="Wyczyść ranking i odznaki">Wyczyść ranking i odznaki</button>
        <small>Usuwa lokalne dane quizu z tej przeglądarki.</small>
      </div>
    </div>

    <!-- 3 kafelki -->
    <section class="stack" style="display:grid;gap:16px;grid-template-columns:repeat(3,1fr);align-items:stretch;">
      <article class="card"><a href="kobieta.html"><img src="img/kobieta-model1.png" alt="Kobieta"/><div class="caption"><h3>Kobieta</h3>→</div></a></article>
      <article class="card"><a href="mezczyzna.html"><img src="img/mezczyzna-model1.png" alt="Mężczyzna"/><div class="caption"><h3>Mężczyzna</h3>→</div></a></article>
      <article class="card"><a href="dziecko.html"><img src="img/dziecko-model1.png" alt="Dziecko"/><div class="caption"><h3>Dziecko</h3>→</div></a></article>
    </section>
  </div>

  <canvas id="bh2025-confetti"></canvas>
  <script src="assets/main.js?v=10"></script>

  <script>
  (function(){
    var KEY='quizBadges', KEY_HIST='quizBadgesHistory';
    function load(k,d){ try{return JSON.parse(localStorage.getItem(k)||JSON.stringify(d));}catch(e){return d;} }
    function save(k,v){ try{localStorage.setItem(k,JSON.stringify(v));}catch(e){} }

    function renderBadges(){
      var box=document.getElementById('bh2025-badgebox'),list=document.getElementById('bh2025-badgelist'),note=document.getElementById('bh2025-badgenote');
      if(!box||!list||!note)return; var data=load(KEY,{score:0,badges:[]});
      if(!data.badges.length){box.hidden=true;return;}
      box.hidden=false; list.innerHTML='';
      data.badges.forEach(b=>{var s=document.createElement('span');s.textContent=b;list.appendChild(s);});
      note.textContent='Najlepszy wynik: '+(data.score||0)+'/3 • Odznak: '+data.badges.length;
    }

    function renderLeader(){
      var list=document.getElementById('bh2025-leaderlist'); if(!list)return; var hist=load(KEY_HIST,[]);
      hist.sort((a,b)=>b.score-a.score||b.ts-a.ts); hist=hist.slice(0,5);
      list.innerHTML='';
      hist.forEach(r=>{
        var d=new Date(r.ts);
        list.innerHTML+=`<li><span class="score">${r.score}/3</span> — ${r.badge} <time>${d.toLocaleDateString()} ${d.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})}</time></li>`;
      });
    }

    function confettiBurst(){
      var c=document.getElementById('bh2025-confetti'),ctx=c.getContext('2d');c.width=innerWidth;c.height=innerHeight;c.style.display='block';
      var parts=Array.from({length:120},()=>({x:Math.random()*c.width,y:-20,vx:-1+Math.random()*2,vy:2+Math.random()*2.5,size:3+Math.random()*4,rot:Math.random()*6,vr:-.2+Math.random()*.4,color:['#ff6ec7','#5eead4','#ffd16c'][Math.floor(Math.random()*3)],life:80}));
      function tick(){ctx.clearRect(0,0,c.width,c.height);parts.forEach(p=>{p.x+=p.vx;p.y+=p.vy;p.rot+=p.vr;p.vy+=0.02;p.life--;ctx.save();ctx.translate(p.x,p.y);ctx.rotate(p.rot);ctx.fillStyle=p.color;ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size);ctx.restore();});parts=parts.filter(p=>p.life>0);if(parts.length)requestAnimationFrame(tick);else c.style.display='none';}tick();
    }

    // Hook z quizu
    var _oldAward=window.awardBadge;
    window.awardBadge=function(score){
      if(typeof _oldAward==='function')_oldAward(score);
      var badge=score===3?'🥇':score===2?'🥈':score===1?'🥉':'🏅';
      var d=load(KEY,{score:0,badges:[]});d.score=Math.max(d.score||0,score||0);d.badges.push(badge);save(KEY,d);
      var h=load(KEY_HIST,[]);h.unshift({score, badge, ts:Date.now()});if(h.length>50)h=h.slice(0,50);save(KEY_HIST,h);
      renderBadges();renderLeader(); if(score===3)confettiBurst();
    };

    // RESET przyciskiem
    document.addEventListener('DOMContentLoaded',function(){
      renderBadges();renderLeader();
      var btn=document.getElementById('bh2025-reset-btn');
      if(btn){
        btn.addEventListener('click',function(){
          if(confirm('Na pewno usunąć lokalne odznaki i ranking?')){
            try{ localStorage.removeItem(KEY); localStorage.removeItem(KEY_HIST); }catch(e){}
            renderBadges();renderLeader();
            // mini „pozytywny” błysk po resecie
            var c=document.getElementById('bh2025-confetti'),ctx=c.getContext('2d');
            c.width=innerWidth;c.height=innerHeight;c.style.display='block';
            var parts=Array.from({length:40},()=>({x:innerWidth/2,y:innerHeight/2,vx:-3+Math.random()*6,vy:-3+Math.random()*6,size:3+Math.random()*3,rot:Math.random()*6,vr:-.3+Math.random()*.6,color:'#5eead4',life:30}));
            (function flash(){ctx.clearRect(0,0,c.width,c.height);parts.forEach(p=>{p.x+=p.vx;p.y+=p.vy;p.rot+=p.vr;p.vy+=0.02;p.life--;ctx.save();ctx.translate(p.x,p.y);ctx.rotate(p.rot);ctx.fillStyle=p.color;ctx.fillRect(-p.size/2,-p.size/2,p.size,p.size);ctx.restore();});parts=parts.filter(p=>p.life>0);if(parts.length)requestAnimationFrame(flash);else c.style.display='none';})();
          }
        });
      }
    });
  })();
  </script>
</body>
</html>
