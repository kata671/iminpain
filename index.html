<!doctype html>
<html lang="pl" data-lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Boli Help ‚Äî Strona g≈Ç√≥wna</title>
  <meta name="theme-color" content="#0e1230" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="/icons/icon-192.png" sizes="192x192" type="image/png">
  <link rel="apple-touch-icon" href="/icons/icon-512.png">

  <!-- CSS (cache-bust v=12) -->
  <link rel="stylesheet" href="assets/style.css?v=12" />

  <style>
    html,body{height:100%}
    body[data-page="home"]{
      position:relative; background:#0e1230 !important; color:#eef2ff;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    body[data-page="home"]::before,
    body[data-page="home"]::after,
    body[data-page="home"] .container::before,
    body[data-page="home"] .container::after{content:none !important;display:none !important}

    .bh-wallpaper,.bh-grid{position:fixed;inset:0;pointer-events:none}
    .bh-wallpaper{
      z-index:0;
      background:
        radial-gradient(42vw 36vh at 16% 12%, rgba(255,110,199,.30), transparent 60%),
        radial-gradient(36vw 30vh at 84% 10%, rgba(94,234,212,.22), transparent 60%),
        radial-gradient(40vw 44vh at 20% 88%, rgba(164,107,255,.16), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0));
      filter: blur(10px) saturate(118%);
    }
    .bh-grid{
      z-index:1; opacity:.22;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='104' viewBox='0 0 120 104'%3E%3Cg fill='none' stroke='rgba(173,216,255,0.26)' stroke-width='1'%3E%3Cpolygon points='30,0 90,0 120,52 90,104 30,104 0,52'/%3E%3C/g%3E%3C/svg%3E");
      background-size:160px 138px; background-position:center;
    }
    .bh-floor-fade{ position:fixed; left:0; right:0; bottom:0; height:120px; z-index:2; pointer-events:none;
      background:linear-gradient(180deg, rgba(14,18,48,0), rgba(14,18,48,.35) 55%, rgba(14,18,48,.6)); }
    .container{position:relative;z-index:3;background:transparent !important;max-width:1100px;margin:0 auto;padding:0 16px}

    /* Siatka kart */
    @media (min-width:981px){ section.stack[style]{grid-template-columns:repeat(3,1fr) !important;} }
    @media (max-width:980px){ section.stack[style]{grid-template-columns:repeat(2,1fr) !important;} }
    @media (max-width:640px){ section.stack[style]{grid-template-columns:1fr !important;} }
    section.stack[style] > *{grid-column:auto !important;min-width:0 !important}

    .card{border-radius:18px;overflow:hidden;background:rgba(60,32,100,.32);border:1px solid rgba(164,107,255,.22);
      box-shadow:0 10px 22px rgba(255,110,199,.12), 0 0 0 1px rgba(164,107,255,.14) inset;min-height:240px}
    .card a{display:grid;grid-template-rows:minmax(180px,240px) auto;height:100%;text-decoration:none;color:inherit}
    .card img{width:100%;height:100%;object-fit:contain;object-position:center;
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02))}
    .card .caption{display:flex;align-items:center;justify-content:space-between;gap:8px;padding:12px 14px;
      border-top:1px solid rgba(164,107,255,.22);background:rgba(255,255,255,.04)}

    /* Pigu≈Çki */
    :root{ --bhG:34,227,160; --bhG2:20,160,120; }
    .situations .pill{
      display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:14px; text-decoration:none; font-weight:900;
      border:1px solid rgba(255,255,255,.18); background:rgba(255,255,255,.06); color:#fff; transition:.2s ease;
    }
    .situations .pill .ico{
      display:inline-grid; place-items:center; width:22px; height:22px; border-radius:6px;
      background: rgba(164,107,255,.18); box-shadow: inset 0 0 0 1px rgba(164,107,255,.25);
    }
    .situations .pill.pill--green{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)), rgba(var(--bhG2), .15);
      color:#ffffff; border:1px solid rgba(var(--bhG), .55);
      box-shadow:0 8px 20px rgba(8,10,22,.35), 0 0 0 1px rgba(var(--bhG), .25) inset, 0 0 18px rgba(var(--bhG), .18);
      backdrop-filter:saturate(125%) blur(4px);
    }
    .situations .pill.pill--green:hover,
    .situations .pill.pill--green:focus-visible{
      transform:translateY(-1px); border-color:rgba(var(--bhG), .85);
      box-shadow:0 14px 26px rgba(8,10,22,.45), 0 0 0 2px rgba(var(--bhG), .65), 0 0 26px rgba(var(--bhG), .45);
      outline:none;
    }
    .situations .pill.pill--blue{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)), rgba(96,165,250,.18);
      border:1px solid rgba(59,130,246,.6);
      box-shadow:0 8px 20px rgba(8,10,22,.35), 0 0 0 1px rgba(59,130,246,.35) inset, 0 0 18px rgba(96,165,250,.30);
      color:#eaf2ff;
    }
    .situations .pill.pill--blue:hover,
    .situations .pill.pill--blue:focus-visible{
      transform:translateY(-1px); border-color:rgba(59,130,246,.9);
      box-shadow:0 14px 26px rgba(8,10,22,.45), 0 0 0 2px rgba(96,165,250,.65), 0 0 26px rgba(96,165,250,.5);
      outline:none;
    }

    /* apteka24 ‚Äì ≈õwiecƒÖcy badge */
    #btn-apteka .badge-round{
      background: rgba(var(--bhG), .18);
      color: #eafff7;
      border:1px solid rgba(var(--bhG), .55);
      box-shadow:0 6px 18px rgba(8,10,22,.35), inset 0 0 0 1px rgba(var(--bhG), .20), 0 0 14px rgba(var(--bhG), .30);
      font-weight:800; letter-spacing:.2px; border-radius:999px; padding:6px 10px; text-transform:none;
      animation: bh-green-pulse 2.4s ease-in-out infinite;
    }
    @keyframes bh-green-pulse{
      0%{ box-shadow:0 0 0 0 rgba(var(--bhG), .00), 0 0 12px rgba(var(--bhG), .18) }
      50%{ box-shadow:0 0 0 6px rgba(var(--bhG), .12), 0 0 22px rgba(var(--bhG), .35) }
      100%{ box-shadow:0 0 0 0 rgba(var(--bhG), .00), 0 0 12px rgba(var(--bhG), .18) }
    }

    .bh2025-porada__svg img{
      max-width:100%; height:auto; display:block; border-radius:12px;
      border:1px solid rgba(255,255,255,.16); background:rgba(255,255,255,.04);
    }

    .bh2025-modal[aria-hidden="true"],
    .bh2025-porada[aria-hidden="true"]{ display:none }

    .bh2025-cta-quiz{appearance:none;border:1px solid rgba(164,107,255,.28);
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      color:#eef2ff;border-radius:14px;padding:10px 14px;font-weight:800;cursor:pointer}
    .bh2025-modal{position:fixed;inset:0;z-index:9999;background:radial-gradient(50% 50% at 50% 50%, rgba(14,18,48,.88), rgba(14,18,48,.92));backdrop-filter:saturate(120%) blur(6px)}
    .bh2025-modal__panel{position:relative;max-width:720px;margin:6vh auto;background:rgba(60,32,100,.36);border:1px solid rgba(164,107,255,.25);border-radius:18px;padding:16px;color:#eef2ff}
    .bh2025-q{color:#ffffff;font-weight:900;letter-spacing:.2px}
    .bh2025-answers .bh2025-ans{display:block;width:100%;text-align:left;margin:8px 0;padding:10px 12px;border-radius:12px;
      border:1px solid rgba(255,255,255,.22);background:rgba(255,255,255,.08);cursor:pointer;color:#ffffff}
    .bh2025-answers .bh2025-ans:hover{box-shadow:0 10px 20px rgba(0,0,0,.25);transform:translateY(-1px)}
    .bh2025-ans.correct{box-shadow:0 0 0 2px rgba(94,234,212,.65)}
    .bh2025-ans.wrong{box-shadow:0 0 0 2px rgba(255,107,107,.7)}
    .bh2025-progress{display:flex;align-items:center;gap:10px;margin:8px 0 12px}
    .bh2025-progress__bar{flex:1;height:12px;border-radius:999px;outline:1px solid rgba(255,255,255,.14);background:linear-gradient(90deg,#5eead4,#ff6ec7);position:relative;overflow:hidden}
    .bh2025-progress__cursor{position:absolute;top:50%;transform:translate(-50%,-50%);left:6%;width:16px;height:16px;border-radius:50%;background:#fff;box-shadow:0 0 0 2px rgba(94,234,212,.35)}

    .bh2025-porada{position:fixed;inset:0;z-index:9998;background:radial-gradient(50% 50% at 50% 50%, rgba(14,18,48,.9), rgba(14,18,48,.95));backdrop-filter:saturate(120%) blur(6px)}
    .bh2025-porada__panel{position:relative;max-width:980px;margin:5vh auto;background:rgba(60,32,100,.36);border:1px solid rgba(164,107,255,.25);border-radius:18px;padding:16px;color:#eef2ff}
    .bh2025-porada__grid{display:grid;grid-template-columns:1.1fr 1fr;gap:14px}
    @media (max-width:900px){ .bh2025-porada__grid{grid-template-columns:1fr} }
    .bh2025-steps{border-radius:14px;border:1px solid rgba(255,255,255,.16);background:rgba(255,255,255,.05);padding:12px}

    /* Selektor jƒôzyka */
    .langpick{display:flex;gap:8px;align-items:center;margin-left:12px}
    .langpick label{font-weight:800;color:#cfe2ff;font-size:13px}
    .langpick select{
      appearance:none;background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.24);
      color:#ffffff; border-radius:10px;padding:6px 10px;cursor:pointer;font-weight:900;letter-spacing:.3px
    }
    .langpick option{ color:#0e1230; background:#ffffff }

    /* Wyszukiwarka ‚Äì panel podpowiedzi (bazowy wyglƒÖd; pozycja nadpisywana przez portal) */
    .bh2025-suggest{position:absolute;right:0;left:0;top:100%;margin-top:6px;z-index:50;
      background:rgba(60,32,100,.96); border:1px solid rgba(164,107,255,.28); border-radius:12px;
      box-shadow:0 16px 34px rgba(8,10,22,.52); overflow:hidden; display:none}
    .bh2025-suggest[aria-hidden="false"]{display:block}
    .bh2025-sg-head{padding:8px 12px; font-weight:800; letter-spacing:.2px; color:#cfe2ff;
      border-bottom:1px solid rgba(164,107,255,.18); background:rgba(255,255,255,.03)}
    .bh2025-sg-list{list-style:none;margin:0;padding:6px}
    .bh2025-sg-item{display:flex;align-items:center;gap:10px;padding:8px 10px;border-radius:10px;
      cursor:pointer; color:#eef2ff; text-decoration:none; border:1px solid transparent}
    .bh2025-sg-item:hover,
    .bh2025-sg-item[aria-selected="true"]{background:rgba(255,255,255,.06); border-color:rgba(164,107,255,.28);
      box-shadow:inset 0 0 0 1px rgba(164,107,255,.16)}
    .bh2025-sg-ico{width:18px;height:18px;display:inline-grid;place-items:center;border-radius:6px;
      background:rgba(164,107,255,.18); font-size:12px}
    .bh2025-sg-sub{margin-left:auto;font-size:12px;color:#b8c2e0}
    .header .tools .search{position:relative}
  </style>
</style>

<!-- MOBILE POLISH + NOWOCZESNE SIATKI (nie rusza desktopu) -->
<style id="bh-mobile-polish">
@media (max-width: 640px){
  html, body { overflow-x: hidden; }
  .container { padding: 0 14px; }

  nav.situations{
    display:grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    gap: 10px !important;
    margin: 14px 0 10px !important;
  }
  nav.situations .pill{
    height: 54px !important;
    border-radius: 14px !important;
    justify-content: center !important;
    font-size: 14px !important;
    letter-spacing: .2px !important;
    line-height: 1.15 !important;
    padding: 8px 10px !important;
  }
  nav.situations .pill .ico{
    width: 22px !important; height: 22px !important; border-radius: 7px !important;
  }

  .actions{
    display:grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    gap: 10px !important;
    margin: 14px 0 12px !important;
  }
  .actions .btn{
    height: 52px !important;
    border-radius: 14px !important;
    font-size: 14px !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  #btn-hosp span, #btn-apteka .badge-round { font-size: 12.5px !important; }

  section.stack[aria-label="Wyb√≥r postaci"]{
    display:grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    gap: 12px !important;
  }
  @media (max-width: 380px){
    section.stack[aria-label="Wyb√≥r postaci"]{
      grid-template-columns: 1fr !important;
    }
  }
  section.stack .card{
    min-height: 220px !important;
    border-radius: 16px !important;
  }
  section.stack .card a{
    grid-template-rows: minmax(160px, 200px) auto !important;
  }
  section.stack .card img{
    object-fit: cover !important;
    object-position: 50% 24% !important;
  }
  section.stack .card .caption{
    padding: 10px 12px !important;
  }

  .header .tools .search{
    flex: 1 1 auto !important;
    min-width: 0 !important;
  }
  #bhSearch{
    width: 100% !important;
    padding: 10px 34px 10px 12px !important;
    border-radius: 12px !important;
    border: 1px solid rgba(255,255,255,.20) !important;
    background: rgba(255,255,255,.06) !important;
    color: #fff !important;
    font-size: 14px !important;
  }
  #bhSearchIcon{
    position: absolute !important; right: 10px !important; top: 50% !important; transform: translateY(-50%) !important;
  }
  .bh2025-suggest{ left: 0 !important; right: 0 !important; }

  #bhLangPick{
    top: 10px !important; right: 10px !important;
    padding: 5px 8px !important;
  }

  .situations .pill:active, .actions .btn:active{
    transform: translateY(0) !important;
    box-shadow: 0 0 0 2px rgba(164,107,255,.35) inset !important;
  }
}
</style>

<!-- SP√ìJNY WYGLƒÑD T≈ÅUMACZA (PL/EN) -->
<style>
#bhLangPick {
  position: fixed !important; top: 16px !important; right: 24px !important; z-index: 9999 !important;
  display: inline-flex !important; align-items: center; gap: 6px;
  background: rgba(255,255,255,.08); border: 1px solid rgba(255,255,255,.22);
  border-radius: 12px; padding: 6px 10px; backdrop-filter: saturate(120%) blur(6px);
}
#bhLangPick label { display: none !important }
#bhLangSelect {
  font-size: 14px; font-weight: 700; color: #fff; background: transparent; border: none; outline: none; cursor: pointer; letter-spacing: .3px;
}
#bhLangSelect option { color: #0e1230; background: #ffffff }
@media (max-width:768px){
  #bhLangPick{ top: 10px !important; right: 12px !important; padding: 5px 8px }
  #bhLangSelect{ font-size: 13px }
}
</style>
</head>
<body data-page="home">
  <div class="bh-wallpaper" aria-hidden="true"></div>
  <div class="bh-grid" aria-hidden="true"></div>
  <div class="bh-floor-fade" aria-hidden="true"></div>

  <div class="container">
    <header class="header">
      <div class="brand">
        <h1 data-i18n="brand_title">Boli Help</h1>
        <small data-i18n="brand_sub">Pomoc i pierwsza pomoc w nag≈Çych sytuacjach</small>
      </div>
      <div class="tools" style="display:flex;align-items:center;gap:10px">
        <div class="search" role="search">
          <input id="bhSearch" type="search" placeholder="Szukaj objawu, czƒô≈õci cia≈Ça lub tematu‚Ä¶" aria-label="Szukaj" />
          <svg id="bhSearchIcon" width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true" style="cursor:pointer">
            <path d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15Z"
                  stroke="white" stroke-opacity=".7" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>

        <!-- T≈Çumacz PL/EN -->
        <div class="langpick" id="bhLangPick" aria-label="Wyb√≥r jƒôzyka">
          <label for="bhLangSelect">Jƒôzyk</label>
          <select id="bhLangSelect">
            <option value="pl">PL</option>
            <option value="en">EN</option>
          </select>
        </div>
      </div>
    </header>

    <div class="emergency-list" aria-label="Telefony alarmowe">
      <a href="tel:112">üìû 112</a><a href="tel:999">üöë 999</a><a href="tel:998">üî• 998</a><a href="tel:997">üëÆ 997</a>
    </div>

    <nav class="situations" aria-label="Sytuacje nag≈Çe">
      <a class="pill pill--green" data-porada="zadlawienie" href="szczegoly.html?typ=porada&czesc=zadlawienie&label=Zad%C5%82awienie">
        <span class="ico">ü´Å</span><span data-i18n="pill_choke">Zad≈Çawienie</span>
      </a>
      <a class="pill pill--green" data-porada="reanimacja" href="szczegoly.html?typ=porada&czesc=reanimacja&label=Reanimacja">
        <span class="ico">üöë</span><span data-i18n="pill_cpr">Reanimacja</span>
      </a>
      <a class="pill pill--green" data-porada="wypadek" href="szczegoly.html?typ=porada&czesc=wypadek&label=Wypadek">
        <span class="ico">üí•</span><span data-i18n="pill_accident">Wypadek</span>
      </a>
      <a class="pill pill--green" data-porada="pierwszopomoc" href="szczegoly.html?typ=porada&czesc=pierwszopomoc&label=Pierwsza%20pomoc">
        <span class="ico">‚ù§Ô∏è‚Äçü©π</span><span data-i18n="pill_firstaid">Pierwsza pomoc</span>
      </a>
      <a class="pill pill--blue" href="gry.html">
        <span class="ico">üéÆ</span><span data-i18n="pill_games">Gry / Trening</span>
      </a>
      <a class="pill pill--blue" href="quizzes.html" id="btn-quizzes">
        <span class="ico">üß†</span><span data-i18n="pill_quizzes">Quizy</span>
      </a>
    </nav>

    <div class="actions actions--grid" role="navigation" aria-label="Szybkie akcje">
      <button id="btn-112" class="btn btn--red btn--call" type="button">üìû 112</button>
      <button id="btn-hosp" class="btn btn--hosp" type="button" data-i18n="btn_hosp">üè• Szpitale / SOR</button>
      <a id="btn-apteka" class="btn" href="https://www.google.com/maps/search/apteka+otwarta+teraz/" target="_blank" rel="noopener">
        <span class="badge-round">apteka24</span></a>
      <a id="btn-dent24" class="btn" href="dentysta24.html">ü¶∑ B√≥l zƒôba 24H</a>
      <button id="btn-loc" class="btn" type="button" data-i18n="btn_loc">üìç Zlokalizuj mnie</button>
    </div>

    <div class="subheadline" data-i18n="subheadline">Boli mnie ‚Äî wybierz obszar b√≥lu</div>

    <!-- 3 kafelki -->
    <section class="stack" aria-label="Wyb√≥r postaci"
      style="display:grid;gap:16px;grid-template-columns:repeat(3,1fr);align-items:stretch;">
      <article class="card">
        <a href="kobieta.html">
          <img src="img/kobieta-model1.png" alt="Kobieta ‚Äî wybierz czƒô≈õƒá cia≈Ça" onerror="this.src='img/placeholder.png'"/>
          <div class="caption"><h3 data-i18n="card_woman">Kobieta</h3><span class="arrow" aria-hidden="true">‚Üí</span></div>
        </a>
      </article>
      <article class="card">
        <a href="mezczyzna.html">
          <img src="img/mezczyzna-model1.png" alt="Mƒô≈ºczyzna ‚Äî wybierz czƒô≈õƒá cia≈Ça" onerror="this.src='img/placeholder.png'"/>
          <div class="caption"><h3 data-i18n="card_man">Mƒô≈ºczyzna</h3><span class="arrow" aria-hidden="true">‚Üí</span></div>
        </a>
      </article>
      <article class="card">
        <a href="dziecko.html">
          <img src="img/dziecko-model1.png" alt="Dziecko ‚Äî wybierz czƒô≈õƒá cia≈Ça" onerror="this.src='img/placeholder.png'"/>
          <div class="caption"><h3 data-i18n="card_child">Dziecko</h3><span class="arrow" aria-hidden="true">‚Üí</span></div>
        </a>
      </article>
    </section>
  </div>

  <!-- Modal PORADA -->
  <div id="bh2025Porada" class="bh2025-porada" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="bh2025PoradaTitle">
    <div class="bh2025-porada__panel">
      <div class="bh2025-porada__head">
        <div class="bh2025-porada__title" id="bh2025PoradaTitle" data-i18n="advice_title">Porada</div>
        <div class="bh2025-chip" id="bh2025PoradaChip" data-i18n="advice_chip">SOS ‚Ä¢ instrukcja</div>
        <button class="bh2025-close--porada" type="button" id="bh2025PoradaClose" aria-label="Zamknij" data-i18n="close_btn">‚úï</button>
      </div>
      <div class="bh2025-porada__grid">
        <div class="bh2025-porada__svg" id="bh2025PoradaSvg" aria-label="Instrukcja obrazkowa"></div>
        <div class="bh2025-steps"><ol id="bh2025PoradaSteps"></ol></div>
      </div>
      <div class="bh2025-video">
        <div class="bh2025-muted" style="margin-bottom:8px;font-weight:800" data-i18n="video_head">Materia≈Ç wideo</div>
        <div id="bh2025VideoWrap"><div class="ph" id="bh2025VideoPh"><span>üé¨</span><span data-i18n="video_hint">Dodaj plik: <code>assets/videos/&lt;nazwa&gt;.mp4</code> i zaktualizuj mapƒô poni≈ºej.</span></div></div>
      </div>
    </div>
  </div>

  <!-- Skrypt bazowy strony -->
  <script src="assets/main.js?v=12"></script>

  <!-- PORADY (klik pigu≈Çek przechwycony w capture) -->
  <script>
  (function(){
    const poradaModal  = document.getElementById('bh2025Porada');
    const poradaClose  = document.getElementById('bh2025PoradaClose');
    const poradaTitle  = document.getElementById('bh2025PoradaTitle');
    const svgWrap      = document.getElementById('bh2025PoradaSvg');
    const stepsOl      = document.getElementById('bh2025PoradaSteps');
    const videoWrap    = document.getElementById('bh2025VideoWrap');
    const videoPh      = document.getElementById('bh2025VideoPh');
    if(!poradaModal || poradaModal.dataset.bhBound) return; poradaModal.dataset.bhBound='1';

    const IMG = { zadlawienie: 'img/zadlawienie.png', reanimacja: 'img/reanimacja.png', wypadek: 'img/wypadek.png', pierwszopomoc: null };
    const STEPS = {
      pl:{
        zadlawienie:["Zachƒôcaj do kaszlu ‚Äî je≈õli skuteczny, obserwuj.","Brak skutecznego kaszlu: 5 uderze≈Ñ w plecy miƒôdzy ≈Çopatki.","Je≈õli nieskuteczne: 5 uci≈õniƒôƒá nadbrzusza.","Na zmianƒô: 5 plecy ‚Üî 5 nadbrzusze, a≈º do skutku.","Utrata przytomno≈õci: RKO 30:2, 112, AED."],
        reanimacja:["Sprawd≈∫ bezpiecze≈Ñstwo, reakcjƒô i oddech (max 10 s).","Brak oddechu: zadzwo≈Ñ 112.","Uciski: 100‚Äì120/min, g≈Çƒôb. 5‚Äì6 cm, ≈õrodek mostka.","Po 30 uci≈õniƒôciach 2 oddechy (je≈õli umiesz i chcesz).","Kontynuuj do przyjazdu s≈Çu≈ºb lub powrotu oddechu."],
        wypadek:["Zabezpiecz miejsce.","Oce≈Ñ liczbƒô poszkodowanych i zagro≈ºenia.","Wezwij 112.","Priorytet: oddech, krwotoki (ucisk).","Nie przestawiaj bez potrzeby."],
        pierwszopomoc:["ABC: dro≈ºno≈õƒá, oddech, krƒÖ≈ºenie.","Pozycja bezpieczna przy oddechu.","Ucisk krwotok√≥w.","Oparzenia: ch≈Çodzenie 20 min.","Wezwij pomoc, gdy masz wƒÖtpliwo≈õci."]
      },
      en:{
        zadlawienie:["Encourage coughing ‚Äî if effective, observe.","If not effective: 5 back blows.","Then 5 abdominal thrusts.","Alternate 5‚Üî5 until success.","If unconscious: CPR 30:2, call 112/911, AED."],
        reanimacja:["Check safety, response, breathing (‚â§10 s).","No breathing: call 112/911.","Compressions 100‚Äì120/min, depth 5‚Äì6 cm, center chest.","30 compressions + 2 breaths (if trained).","Continue until help arrives/returns breathing."],
        wypadek:["Make scene safe.","Assess casualties/hazards.","Call 112/911.","Priority: breathing, bleeding (direct pressure).","Do not move unnecessarily."],
        pierwszopomoc:["ABC: airway, breathing, circulation.","Recovery position if breathing.","Control bleeding.","Burns: cool 20 min.","When in doubt ‚Äî call for help."]
      }
    };
    const L = ()=> (window.__getLang && window.__getLang()) || 'pl';

    function openPorada(key, title){
      poradaTitle.textContent = title || (L()==='en'?'Advice':'Porada');
      svgWrap.innerHTML=''; const src=IMG[key];
      if(src){ const img=new Image(); img.src=src; img.alt=title||key; svgWrap.appendChild(img); }
      stepsOl.innerHTML=''; (STEPS[L()]?.[key]||[]).forEach(txt=>{ const li=document.createElement('li'); li.textContent=txt; stepsOl.appendChild(li); });
      videoWrap.innerHTML=''; videoWrap.appendChild(videoPh.cloneNode(true));
      poradaModal.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden';
    }
    function closePorada(){ poradaModal.setAttribute('aria-hidden','true'); document.body.style.overflow=''; }

    const nav = document.querySelector('nav.situations');
    if(nav && !nav.dataset.bhPoradaBound){
      nav.dataset.bhPoradaBound='1';
      nav.addEventListener('click', function(e){
        const a = e.target.closest('a.pill.pill--green[data-porada]');
        if(!a) return;
        e.preventDefault(); e.stopPropagation(); e.stopImmediatePropagation();
        const key   = a.getAttribute('data-porada');
        const title = a.textContent.trim();
        openPorada(key, title);
      }, true);
    }

    poradaClose.addEventListener('click', closePorada);
    poradaModal.addEventListener('click', (e)=>{ if(e.target===poradaModal) closePorada(); });
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && poradaModal.getAttribute('aria-hidden')==='false') closePorada(); });
  })();
  </script>

  <!-- WYSZUKIWARKA (PL/EN) ‚Äî ROZSZERZONA, z odmianami i bez PL znak√≥w -->
  <script>
  (function(){
    const input = document.getElementById('bhSearch');
    const icon  = document.getElementById('bhSearchIcon');
    if(!input) return;

    // Usu≈Ñ ewentualny stary dropdown
    const prev = input.parentElement.querySelector('.bh2025-suggest');
    if(prev){ prev.remove(); }

    const dePL = (s)=>
      s.normalize('NFD')
       .replace(/[\u0300-\u036f]/g,'')
       .replaceAll('≈Ç','l').replaceAll('≈Å','l')
       .replaceAll('≈õ','s').replaceAll('≈ö','s')
       .replaceAll('≈º','z').replaceAll('≈ª','z')
       .replaceAll('≈∫','z').replaceAll('≈π','z')
       .replaceAll('ƒá','c').replaceAll('ƒÜ','c')
       .replaceAll('ƒÖ','a').replaceAll('ƒÑ','a')
       .replaceAll('ƒô','e').replaceAll('ƒò','e')
       .replaceAll('√≥','o').replaceAll('√ì','o');
    const norm = (s)=> dePL(String(s||'').toLowerCase().trim());

    const LEMMAS = {
      'oko':'oko','oczy':'oko','oczami':'oko','wzrok':'oko',
      'nos':'nos','zatoki':'nos','katar':'nos',
      'gardlo':'gardlo','angina':'gardlo','chrypka':'gardlo','bolgardla':'gardlo',
      'glowa':'glowa','migrena':'glowa','bolglowy':'glowa',
      'klatka':'klatka','piers':'klatka','mostek':'klatka',
      'pluca':'pluca','duszno':'pluca','dyszenie':'pluca','astma':'pluca',
      'brzuch':'brzuch','zoladek':'brzuch','wzdecia':'brzuch','biegunka':'brzuch',
      'nerki':'nerki','nerka':'nerki','ledzwie':'nerki','kolka':'nerki',
      'plecy':'plecy','kregoslup':'plecy','rwa':'plecy',
      'biodra':'biodra','biodro':'biodra','udo':'uda','uda':'uda','pachwina':'biodra',
      'kolano':'kolano','kolana':'kolano','rzepka':'kolano','lakotka':'kolano',
      'lydka':'lydka','lydki':'lydka','skurcze lydki':'lydka','skurcz lydki':'lydka',
      'kostka':'kostka','kostki':'kostka','skrecenie kostki':'kostka','zwichniecie kostki':'kostka',
      'stopy':'stopy','stopa':'stopy','pieta':'stopy','rozciagno':'stopy','rozciagnosc':'stopy',
      'skora':'skora','wysypka':'skora','swid':'skora','alergia':'skora',
      'serce':'serce','kolatanie':'serce','arytmia':'serce','kolatanieserca':'serce',
      'kaszel':'kaszel','kaszle':'kaszel',
      'goraczka':'goraczka','temperatura':'goraczka',
      'uszy':'uszy','ucho':'uszy','uchem':'uszy','uszu':'uszy','bolucha':'uszy',
      'szyja':'szyja','kark':'szyja','bolszyi':'szyja','bolkarku':'szyja',
      'zeby':'zeby','zub':'zeby','zab':'zeby','zebybol':'zeby','bolzeba':'zeby','stomatolog':'zeby','dentysta':'zeby',
      'ciaza':'ciaza','wciazy':'ciaza','ciezarna':'ciaza','ciazowe':'ciaza','pregnancy':'ciaza',
      'strefaintymna':'strefa','intymna':'strefa','intymne':'strefa','narzadyplciowe':'strefa','okoliceintymne':'strefa',
    };

    const PARTS = [
      {id:'oko',       label:'Oko',        alias:['oko','oczy','wzrok']},
      {id:'nos',       label:'Nos',        alias:['nos','zatoki','katar']},
      {id:'gardlo',    label:'Gard≈Ço',     alias:['gardlo','gard≈Ço','angina','chrypka','bol gardla']},
      {id:'glowa',     label:'G≈Çowa',      alias:['glowa','g≈Çowa','migrena','bol glowy']},
      {id:'szyja',     label:'Szyja',      alias:['szyja','kark','bol szyi','bol karku']},
      {id:'uszy',      label:'Uszy',       alias:['uszy','ucho','uchem','bol ucha','szum w uszach']},
      {id:'zeby',      label:'Zƒôby',       alias:['zeby','zab','zub','bol zeba','stomatolog','dentysta']},

      {id:'klatka',    label:'Klatka piersiowa', alias:['klatka','piers','mostek']},
      {id:'pluca',     label:'P≈Çuca',      alias:['pluca','p≈Çuca','dyszenie','duszno','astma']},
      {id:'serce',     label:'Serce',      alias:['serce','kolatanie','arytmia']},
      {id:'brzuch',    label:'Brzuch',     alias:['brzuch','zoladek','wzdecia','biegunka']},
      {id:'nerki',     label:'Nerki',      alias:['nerki','nerka','ledzwie','kolka']},
      {id:'plecy',     label:'Plecy',      alias:['plecy','kregoslup','rwa']},

      {id:'biodra',    label:'Biodra/Uda', alias:['biodra','biodro','udo','uda','pachwina']},
      {id:'kolano',    label:'Kolano',     alias:['kolano','kolana','rzepka','lakotka']},
      {id:'lydka',     label:'≈Åydka',      alias:['lydka','lydki','skurcz lydki','skurcze lydki']},
      {id:'kostka',    label:'Kostka',     alias:['kostka','kostki','skrecenie kostki','zwichniecie kostki']},
      {id:'stopy',     label:'Stopy',      alias:['stopy','stopa','pieta','rozciagnosc','rozciagno']},

      {id:'skora',     label:'Sk√≥ra',      alias:['skora','wysypka','swid','alergia']},

      {id:'kaszel',    label:'Kaszel',     alias:['kaszel','kaszle']},
      {id:'goraczka',  label:'GorƒÖczka',   alias:['goraczka','temperatura']},

      {id:'ciaza',     label:'CiƒÖ≈ºa',      alias:['ciaza','w ciazy','ciezarna','pregnancy']},
      {id:'strefa',    label:'Strefa intymna', alias:['strefa intymna','intymna','intymne','narzady plciowe']},

      {id:'zadlawienie', label:'Zad≈Çawienie (SOS)', alias:['zadlawienie','zadlawil','zadlawila'], sos:true},
      {id:'reanimacja',  label:'Reanimacja (RKO)',  alias:['reanimacja','rko','resuscytacja'], sos:true},
      {id:'wypadek',     label:'Wypadek (SOS)',     alias:['wypadek','kolizja','potracenie'], sos:true},
      {id:'pierwszopomoc',label:'Pierwsza pomoc',   alias:['pierwsza pomoc','abc','pierwszopomoc'], sos:true},
    ];

    const INDEX = PARTS.map(p=>{
      const base = norm(p.label);
      const aliases = (p.alias||[]).map(norm);
      const extra = [];
      Object.keys(LEMMAS).forEach(k=>{
        const tgt = LEMMAS[k];
        if(tgt === p.id || (p.id==='strefa' && tgt==='strefa')) extra.push(k);
      });
      const lemmaAliases = extra.map(norm);
      const all = Array.from(new Set([base, ...aliases, ...lemmaAliases]));
      return {...p, _keys: all};
    });

    const panel = document.createElement('div');
    panel.className = 'bh2025-suggest';
    panel.setAttribute('role','listbox');
    panel.setAttribute('aria-hidden','true');
    panel.innerHTML = `<div class="bh2025-sg-head">Podpowiedzi</div><ul class="bh2025-sg-list" id="bh2025List"></ul>`;
    input.parentElement.appendChild(panel);
    const list = panel.querySelector('#bh2025List');

    const GENDERS = [
      {id:'kobieta',label:'Kobieta'},
      {id:'mezczyzna',label:'Mƒô≈ºczyzna'},
      {id:'dziecko',label:'Dziecko'}
    ];

    function buildUrls(hit){
      if(hit.sos){
        const url = `szczegoly.html?typ=porada&czesc=${encodeURIComponent(hit.id)}&label=${encodeURIComponent(hit.label)}`;
        return [{label: hit.label, url, sub:'SOS'}];
      }
      return GENDERS.map(g=>{
        const url = `szczegoly.html?typ=${g.id}&czesc=${encodeURIComponent(hit.id)}&label=${encodeURIComponent(hit.label)}`;
        return {label:`${hit.label} ‚Ä¢ ${g.label}`, url, sub:g.label};
      });
    }

    function search(q){
      const s = norm(q);
      if(!s) return [];
      const hits = INDEX.filter(p => p._keys.some(k => k.includes(s) || s.includes(k)));
      const scored = hits.map(p=>{
        const score = p._keys.some(k=>k===s || k.startsWith(s)) ? 0 : 1;
        return {p, score};
      }).sort((a,b)=>a.score-b.score);
      return scored.map(x=>x.p).slice(0,6).flatMap(buildUrls).slice(0,12);
    }

    let results = [], active = -1;

    function render(){
      list.innerHTML = ''; active = -1;
      results.forEach((r,idx)=>{
        const li = document.createElement('li');
        li.setAttribute('role','option'); li.className='bh2025-sg-item'; li.dataset.index = String(idx);
        li.innerHTML = `<span class="bh2025-sg-ico">üîé</span><span>${r.label}</span><span class="bh2025-sg-sub">${r.sub||''}</span>`;
        li.addEventListener('mouseenter', ()=>setActive(idx));
        li.addEventListener('mouseleave', ()=>setActive(-1));
        li.addEventListener('click', ()=>go(idx));
        list.appendChild(li);
      });
      panel.setAttribute('aria-hidden', results.length ? 'false':'true');
      // po pokazaniu ‚Äì niech portal przeliczy pozycjƒô
      document.dispatchEvent(new CustomEvent('bh-suggest-open'));
    }
    function setActive(i){
      active = i;
      list.querySelectorAll('.bh2025-sg-item').forEach((el,idx)=>{
        el.setAttribute('aria-selected', (idx===active)?'true':'false');
      });
    }
    function go(idx){
      const item = results[idx]; if(!item) return;
      window.location.href = item.url;
    }

    input.addEventListener('input', ()=>{ results = search(input.value); render(); });
    input.addEventListener('keydown', (e)=>{
      const shown = panel.getAttribute('aria-hidden')==='false';
      if(e.key==='ArrowDown'){ if(!shown){ results = search(input.value); render(); } setActive( (active+1+results.length)%results.length ); e.preventDefault(); }
      else if(e.key==='ArrowUp'){ if(!shown){ results = search(input.value); render(); } setActive( (active-1+results.length)%results.length ); e.preventDefault(); }
      else if(e.key==='Enter'){
        if(shown && active>=0){ e.preventDefault(); go(active); }
        else { if(!results.length){ results = search(input.value); } if(results[0]) go(0); }
      } else if(e.key==='Escape'){ panel.setAttribute('aria-hidden','true'); active=-1; }
    });
    document.addEventListener('click', (e)=>{ if(!panel.contains(e.target) && e.target!==input){ panel.setAttribute('aria-hidden','true'); active=-1; } });
    if(icon){ icon.addEventListener('click', ()=>{ results = search(input.value); if(results.length){ panel.setAttribute('aria-hidden','false'); render(); } }); }
  })();
  </script>

  <!-- PORTAL dla podpowiedzi ‚Äì dropdown zawsze nad wszystkimi i pod polem -->
  <style id="bh-suggest-portal-css">
    .bh2025-suggest[data-portalized="1"]{
      position: fixed !important;
      z-index: 40001 !important;
      box-shadow: 0 16px 34px rgba(8,10,22,.52);
      border:1px solid rgba(164,107,255,.28);
      border-radius:12px;
      background: rgba(60,32,100,.96);
      overflow:auto;
      -webkit-overflow-scrolling: touch;
    }
  </style>
  <script id="bh-suggest-portal">
  (function(){
    const input    = document.getElementById('bhSearch');
    let dropdown   = document.querySelector('.bh2025-suggest');
    if(!input || !dropdown || dropdown.dataset.portalReady) return;
    dropdown.dataset.portalReady = '1';

    const portal = document.createElement('div');
    portal.id = 'bhSuggestPortal';
    portal.style.position = 'fixed';
    portal.style.zIndex   = '40000';
    portal.style.left     = '0';
    portal.style.top      = '0';
    portal.style.width    = '0';
    portal.style.height   = '0';
    document.body.appendChild(portal);

    portal.appendChild(dropdown);
    dropdown.dataset.portalized = '1';

    function place(){
      if(!dropdown) return;
      const hidden = dropdown.getAttribute('aria-hidden') === 'true';
      if(hidden){ dropdown.style.display = 'none'; return; }
      const r = input.getBoundingClientRect();
      const gutter = 6;
      dropdown.style.display   = 'block';
      dropdown.style.left      = (Math.round(r.left)) + 'px';
      dropdown.style.top       = (Math.round(r.bottom + gutter)) + 'px';
      dropdown.style.width     = (Math.round(r.width)) + 'px';
      dropdown.style.maxHeight = Math.max(180, window.innerHeight - r.bottom - 16) + 'px';
    }

    const mo = new MutationObserver(place);
    mo.observe(dropdown, { attributes:true, attributeFilter:['aria-hidden','style'] });

    ['resize','scroll'].forEach(ev => window.addEventListener(ev, place, {passive:true}));
    input.addEventListener('focus', place);
    input.addEventListener('input', place);
    document.addEventListener('bh-suggest-open', place);
    document.addEventListener('click', (e)=>{
      if(dropdown.getAttribute('aria-hidden')==='true') return;
      if(e.target === input || dropdown.contains(e.target)) return;
      dropdown.setAttribute('aria-hidden','true');
    });
  })();
  </script>

  <!-- Rejestracja Service Workera -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js')
        .then(reg => console.log('SW zarejestrowany:', reg.scope))
        .catch(err => console.error('SW b≈ÇƒÖd:', err));
    }
  </script>

  <!-- Add to Home Screen (iOS/Android) -->
  <script src="assets/a2hs.js?v=1"></script>

  <!-- LEKKI T≈ÅUMACZ PL/EN -->
  <script>
    (function(){
      if(window.__bhI18nBound) return; window.__bhI18nBound = true;

      const I18N = {
        pl: {
          brand_title:"Boli Help",
          brand_sub:"Pomoc i pierwsza pomoc w nag≈Çych sytuacjach",
          pill_choke:"Zad≈Çawienie",
          pill_cpr:"Reanimacja",
          pill_accident:"Wypadek",
          pill_firstaid:"Pierwsza pomoc",
          pill_games:"Gry / Trening",
          pill_quizzes:"Quizy",
          btn_hosp:"üè• Szpitale / SOR",
          btn_loc:"üìç Zlokalizuj mnie",
          subheadline:"Boli mnie ‚Äî wybierz obszar b√≥lu",
          advice_title:"Porada",
          advice_chip:"SOS ‚Ä¢ instrukcja",
          close_btn:"‚úï",
          video_head:"Materia≈Ç wideo",
          video_hint:"Dodaj plik: <code>assets/videos/&lt;nazwa&gt;.mp4</code> i zaktualizuj mapƒô poni≈ºej.",
          card_woman:"Kobieta",
          card_man:"Mƒô≈ºczyzna",
          card_child:"Dziecko",
          search_ph:"Szukaj objawu, czƒô≈õci cia≈Ça lub tematu‚Ä¶",
          sg_head:"Podpowiedzi"
        },
        en: {
          brand_title:"Boli Help",
          brand_sub:"Help and first aid in emergencies",
          pill_choke:"Choking",
          pill_cpr:"CPR",
          pill_accident:"Accident",
          pill_firstaid:"First aid",
          pill_games:"Games / Training",
          pill_quizzes:"Quizzes",
          btn_hosp:"üè• Hospitals / ER",
          btn_loc:"üìç Locate me",
          subheadline:"It hurts ‚Äî choose the area of pain",
          advice_title:"Advice",
          advice_chip:"SOS ‚Ä¢ instructions",
          close_btn:"‚úï",
          video_head:"Video",
          video_hint:"Add file: <code>assets/videos/&lt;name&gt;.mp4</code> and update the map below.",
          card_woman:"Woman",
          card_man:"Man",
          card_child:"Child",
          search_ph:"Search symptom, body part or topic‚Ä¶",
          sg_head:"Suggestions"
        }
      };

      const root = document.documentElement;
      const LS_KEY = 'bh.lang';
      let lang = (localStorage.getItem(LS_KEY) || root.getAttribute('data-lang') || root.lang || 'pl').toLowerCase();
      if(!I18N[lang]) lang = 'pl';

      window.__getLang = () => lang;
      window.__t = (k) => (I18N[lang] && I18N[lang][k]) || (I18N['pl'] && I18N['pl'][k]) || k;

      function applyTranslations(){
        document.querySelectorAll('[data-i18n]').forEach(el=>{
          const key = el.getAttribute('data-i18n');
          const val = window.__t(key);
          if(val!=null){
            if(el.firstChild && el.firstChild.nodeType===3){ el.firstChild.nodeValue = val; }
            else { el.innerHTML = val; }
          }
        });
        const search = document.getElementById('bhSearch');
        if(search){ search.placeholder = window.__t('search_ph'); search.setAttribute('aria-label', window.__t('search_ph')); }
        document.querySelectorAll('.bh2025-sg-head').forEach(el=>{ el.textContent = window.__t('sg_head'); });
        root.setAttribute('lang', lang);
        root.setAttribute('data-lang', lang);
        const lab = document.querySelector('#bhLangPick label');
        if(lab){ lab.textContent = (lang==='en'?'Language':'Jƒôzyk'); }
      }

      function setLang(newLang){
        if(!I18N[newLang]) return;
        lang = newLang;
        localStorage.setItem(LS_KEY, lang);
        applyTranslations();
      }

      const sel = document.getElementById('bhLangSelect');
      if(sel){
        sel.value = lang;
        sel.addEventListener('change', ()=> setLang(sel.value));
      }

      applyTranslations();
    })();
  </script>
<!-- ========== AI WYSZUKIWARKA OBJAW√ìW (LIGHT, CLIENT-SIDE) ========== -->
<style id="bh-ai-scan-css">
  .bh-ai-btn{
    appearance:none; border:1px solid rgba(164,107,255,.28);
    background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.02));
    color:#eef2ff; border-radius:14px; padding:10px 14px; font-weight:800; cursor:pointer;
    box-shadow:0 8px 20px rgba(8,10,22,.35), 0 0 0 1px rgba(164,107,255,.18) inset;
  }
  /* modal */
  .bh-ai-modal[aria-hidden="true"]{ display:none }
  .bh-ai-modal{
    position:fixed; inset:0; z-index:9997;
    background:radial-gradient(50% 50% at 50% 50%, rgba(14,18,48,.9), rgba(14,18,48,.95));
    backdrop-filter:saturate(120%) blur(6px);
  }
  .bh-ai-panel{
    position:relative; max-width:860px; margin:5vh auto; padding:16px;
    background:rgba(60,32,100,.36); border:1px solid rgba(164,107,255,.25); border-radius:18px; color:#eef2ff;
  }
  .bh-ai-grid{ display:grid; grid-template-columns: 1fr 280px; gap:14px }
  @media (max-width:880px){ .bh-ai-grid{ grid-template-columns:1fr } }
  .bh-ai-panel h3{ margin:.2rem 0 6px; font-size:20px; letter-spacing:.2px }
  .bh-ai-panel textarea{
    width:100%; min-height:140px; resize:vertical; padding:12px; border-radius:12px;
    border:1px solid rgba(255,255,255,.18); background:rgba(255,255,255,.06); color:#fff; font-size:15px;
  }
  .bh-ai-row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap }
  .bh-ai-select, .bh-ai-run{
    border-radius:12px; padding:10px 12px; font-weight:800; letter-spacing:.2px; cursor:pointer;
    border:1px solid rgba(255,255,255,.22); background:rgba(255,255,255,.08); color:#fff;
  }
  .bh-ai-run{ background:linear-gradient(180deg, rgba(94,234,212,.25), rgba(94,234,212,.08)); border-color:rgba(94,234,212,.55) }
  .bh-ai-close{
    position:absolute; right:10px; top:10px; border:none; background:transparent; color:#fff; font-size:20px; cursor:pointer;
  }
  .bh-ai-hints{ font-size:13px; color:#cfe2ff }
  .bh-ai-results{ margin-top:10px }
  .bh-ai-result{
    border:1px solid rgba(255,255,255,.18); background:rgba(255,255,255,.06); border-radius:12px; padding:10px; margin:6px 0;
    display:flex; justify-content:space-between; align-items:center; gap:10px;
  }
  .bh-ai-result b{ font-weight:900 }
  .bh-ai-go{
    border-radius:10px; padding:8px 10px; border:1px solid rgba(164,107,255,.35); background:rgba(164,107,255,.15); color:#fff; font-weight:800; cursor:pointer;
  }
</style>

<!-- Przycisk w sekcji akcji (bez dotykania istniejƒÖcych) -->
<script>
(function(){
  const actions = document.querySelector('.actions');
  if(!actions || actions.dataset.aiBtn) return;
  actions.dataset.aiBtn = '1';
  const btn = document.createElement('button');
  btn.className = 'btn bh-ai-btn';
  btn.type = 'button';
  btn.id = 'bhAiOpen';
  btn.innerHTML = 'ü§ñ AI wyszukiwarka objaw√≥w';
  actions.appendChild(btn);
})();
</script>

<!-- Modal + logika -->
<div class="bh-ai-modal" id="bhAiModal" aria-hidden="true" role="dialog" aria-modal="true">
  <div class="bh-ai-panel">
    <button class="bh-ai-close" id="bhAiClose" aria-label="Zamknij">‚úï</button>
    <h3>AI wyszukiwarka objaw√≥w (offline)</h3>
    <div class="bh-ai-grid">
      <div>
        <textarea id="bhAiText" placeholder="Opisz swoje objawy, np.: ‚Äök≈ÇujƒÖcy b√≥l ucha, szum, gorzej w nocy, bez gorƒÖczki‚Äô"></textarea>
        <div class="bh-ai-row" style="margin-top:10px">
          <select id="bhAiTyp" class="bh-ai-select" aria-label="Wybierz profil">
            <option value="kobieta">Kobieta</option>
            <option value="mezczyzna">Mƒô≈ºczyzna</option>
            <option value="dziecko">Dziecko</option>
          </select>
          <button id="bhAiRun" class="bh-ai-run">Analizuj i zaproponuj</button>
        </div>
        <div class="bh-ai-hints" style="margin-top:8px">
          Wspierane: synonimy, liczba mnoga/pojedyncza, brak polskich znak√≥w, proste negacje (np. ‚Äûbez gorƒÖczki‚Äù).
        </div>
        <div id="bhAiResults" class="bh-ai-results" aria-live="polite"></div>
      </div>
      <div>
        <div class="bh-ai-hints">
          <b>Przyk≈Çady:</b><br>
          ‚Ä¢ ‚ÄûpulsujƒÖcy b√≥l g≈Çowy, ≈õwiat≈Çowstrƒôt, nudno≈õci‚Äù<br>
          ‚Ä¢ ‚Äûb√≥l ucha prawego, gorzej w nocy, szumy, bez gorƒÖczki‚Äù<br>
          ‚Ä¢ ‚Äûopuchniƒôta kostka po skrƒôceniu, siniak, b√≥l przy chodzeniu‚Äù<br>
          ‚Ä¢ ‚Äûk≈ÇujƒÖcy b√≥l w klatce, duszno≈õƒá, zimny pot‚Äù<br>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
(function(){
  const modal = document.getElementById('bhAiModal');
  const open  = document.getElementById('bhAiOpen');
  const close = document.getElementById('bhAiClose');
  const run   = document.getElementById('bhAiRun');
  const txt   = document.getElementById('bhAiText');
  const typ   = document.getElementById('bhAiTyp');
  const out   = document.getElementById('bhAiResults');

  if(!open || modal.dataset.bound) return; modal.dataset.bound='1';

  function show(){ modal.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; txt.focus(); }
  function hide(){ modal.setAttribute('aria-hidden','true');  document.body.style.overflow=''; out.innerHTML=''; }

  open.addEventListener('click', show);
  close.addEventListener('click', hide);
  modal.addEventListener('click', (e)=>{ if(e.target===modal) hide(); });
  document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && modal.getAttribute('aria-hidden')==='false') hide(); });

  // --- NLP-light: normalizacja, s≈Çownik, negacje, scoring ---
  const dePL = (s)=>
    s.normalize('NFD')
     .replace(/[\u0300-\u036f]/g,'')
     .replaceAll('≈Ç','l').replaceAll('≈Å','l')
     .replaceAll('≈õ','s').replaceAll('≈ö','s')
     .replaceAll('≈º','z').replaceAll('≈ª','z')
     .replaceAll('≈∫','z').replaceAll('≈π','z')
     .replaceAll('ƒá','c').replaceAll('ƒÜ','c')
     .replaceAll('ƒÖ','a').replaceAll('ƒÑ','a')
     .replaceAll('ƒô','e').replaceAll('ƒò','e')
     .replaceAll('√≥','o').replaceAll('√ì','o');

  const norm = (s)=> dePL(String(s||'').toLowerCase());

  // s≈Çownik hase≈Ç ‚Üí czƒô≈õci cia≈Ça
  const MAP = {
    // g≈Çowa/oko/uszy/nos/gard≈Ço/zƒôby/szyja
    'migrena':'glowa','bol glowy':'glowa','svietlowstret':'glowa','swiatlowstret':'glowa','nudnosci':'glowa',
    'oko':'oko','oczy':'oko','zaburzenia widzenia':'oko','swiatloplas':'oko',
    'ucho':'uszy','uszy':'uszy','szum w uszach':'uszy','szumy':'uszy','bol ucha':'uszy','wydzielina z ucha':'uszy',
    'nos':'nos','katar':'nos','zatoki':'nos','bol zatok':'nos','zapal zatok':'nos',
    'gardlo':'gardlo','bol gardla':'gardlo','angina':'gardlo','chrypka':'gardlo','trudnosc w polykaniu':'gardlo',
    'zab':'zeby','zeby':'zeby','bol zeba':'zeby','nadwrazliwosc':'zeby','opuchlizna zeba':'zeby','ropien':'zeby',
    'szyja':'szyja','kark':'szyja','sztywnosc karku':'szyja',

    // klatka/serce/p≈Çuca
    'klatka':'klatka','bol w klatce':'klatka','mostek':'klatka',
    'serce':'serce','kolatanie':'serce','arytmia':'serce','zimny pot':'serce',
    'duszno≈õƒá':'pluca','dysznost':'pluca','dyszenie':'pluca','kaszel':'pluca','sapka':'pluca','astma':'pluca',

    // brzuch/nerki/plecy/sk√≥ra
    'brzuch':'brzuch','bol brzucha':'brzuch','wzdƒôcia':'brzuch','wzdecia':'brzuch','biegunka':'brzuch','wymioty':'brzuch',
    'nerki':'nerki','kolka nerkowa':'nerki','bol ledzwi':'nerki',
    'plecy':'plecy','rwa kulszowa':'plecy','napiecie miesniowe':'plecy',
    'wysypka':'skora','swidzenie':'skora','swedzenie':'skora','pokrywa':'skora','pokrzywka':'skora',

    // biodra/uda/kolano/≈Çydka/kostka/stopy
    'biodro':'biodra','biodra':'biodra','pachwina':'biodra',
    'udo':'biodra','uda':'biodra',
    'kolano':'kolano','rzepka':'kolano','lakotka':'kolano','opuchlizna kolana':'kolano',
    'lydka':'lydka','skurcz lydki':'lydka','skurcze lydki':'lydka',
    'kostka':'kostka','skrecenie kostki':'kostka','zwichniecie kostki':'kostka','opuchlizna kostki':'kostka',
    'stopa':'stopy','stopy':'stopy','pieta':'stopy','bol przy chodzeniu':'stopy',

    // ciƒÖ≈ºa / strefa
    'ciaza':'ciaza','w ciazy':'ciaza','ciezarna':'ciaza',
    'strefa intymna':'strefa','intymna':'strefa','narzady plciowe':'strefa',

    // SOS
    'zadlawienie':'zadlawienie','reanimacja':'reanimacja','wypadek':'wypadek','pierwsza pomoc':'pierwszopomoc'
  };

  // aliasy wielowyrazowe sprawdzamy najpierw (wa≈ºniejsze od pojedynczych token√≥w)
  const PHRASES = [
    'bol glowy','bol gardla','bol ucha','bol zeba','bol brzucha','bol w klatce',
    'szum w uszach','skurcz lydki','skurcze lydki','opuchlizna kostki','kolka nerkowa','rwa kulszowa',
    'zaburzenia widzenia','trudnosc w polykaniu'
  ];

  // proste negacje ‚Äì je≈õli u≈ºytkownik napisze ‚Äûbez gorƒÖczki‚Äù to ignorujemy trigger gorƒÖczki
  const NEGATIONS = ['bez ','nie ','brak ']; // szukamy prefiks√≥w

  // Mapujemy wynik na label i docelowy URL (typ z selecta)
  const LABELS = {
    oko:'Oko', nos:'Nos', gardlo:'Gard≈Ço', glowa:'G≈Çowa', szyja:'Szyja', uszy:'Uszy', zeby:'Zƒôby',
    klatka:'Klatka piersiowa', pluca:'P≈Çuca', serce:'Serce', brzuch:'Brzuch', nerki:'Nerki', plecy:'Plecy', skora:'Sk√≥ra',
    biodra:'Biodra/Uda', kolano:'Kolano', lydka:'≈Åydka', kostka:'Kostka', stopy:'Stopy',
    ciaza:'CiƒÖ≈ºa', strefa:'Strefa intymna',
    zadlawienie:'Zad≈Çawienie (SOS)', reanimacja:'Reanimacja (RKO)', wypadek:'Wypadek (SOS)', pierwszopomoc:'Pierwsza pomoc'
  };

  function tokenize(s){
    const clean = norm(s).replace(/[^\w\s]/g,' ').replace(/\s+/g,' ').trim();
    return clean ? clean.split(' ') : [];
  }

  function containsNegation(text, word){
    // negacja je≈õli wystƒôpuje "bez <word>" / "nie <word>" / "brak <word>"
    return NEGATIONS.some(neg => text.includes(neg + word));
  }

  function analyze(raw){
    const text = norm(raw);
    if(!text) return null;

    const scores = {}; // id -> punkty
    const add = (id, pts)=>{ scores[id]=(scores[id]||0)+pts; };

    // 1) frazy wielowyrazowe ‚Äì mocniejsze punkty
    PHRASES.forEach(ph=>{
      if(text.includes(ph)){
        const target = MAP[ph] || MAP[ph.replace(/\s+/g,' ')] || null;
        if(target) add(target, 6);
      }
    });

    // 2) tokeny ‚Äì l≈ºejsze punkty
    const toks = tokenize(text);
    toks.forEach(tok=>{
      const target = MAP[tok];
      if(target){
        // sprawd≈∫ negacje dla tokenu (np. "goraczka" gdy jest "bez goraczki")
        if(containsNegation(text, tok)) return;
        add(target, 2);
      }
    });

    // 3) delikatne rozsiewanie (np. ‚Äûszumy‚Äù -> uszy, ale te≈º minimalnie g≈Çowa)
    if(scores['uszy']) add('glowa', 1);
    if(scores['nos'] || scores['gardlo']) add('glowa', 1);
    if(scores['stopy'] || scores['kostka']) add('kolano', 1);

    // wynik
    const items = Object.keys(scores).map(id=>({id, label: LABELS[id]||id, score: scores[id]}))
                    .sort((a,b)=> b.score - a.score);

    if(!items.length) return {items:[], best:null};

    // je≈ºeli lider ma o >=3 pkt wiƒôcej ni≈º drugi ‚Äì traktujemy jako pewny
    const best = (items.length===1 || (items[0].score - items[1].score >= 3)) ? items[0] : null;
    return {items, best};
  }

  function openPart(typVal, id, label){
    const url = `szczegoly.html?typ=${encodeURIComponent(typVal)}&czesc=${encodeURIComponent(id)}&label=${encodeURIComponent(label||LABELS[id]||id)}`;
    window.location.href = url;
  }

  run.addEventListener('click', ()=>{
    const res = analyze(txt.value);
    out.innerHTML = '';
    if(!res || (!res.best && !res.items.length)){
      out.innerHTML = `<div class="bh-ai-result">Nie rozpoznano objaw√≥w. Spr√≥buj dodaƒá wiƒôcej szczeg√≥≈Ç√≥w (lokalizacja b√≥lu, charakter, czas trwania, czynniki).</div>`;
      return;
    }
    if(res.best){
      // od razu przej≈õcie
      openPart(typ.value, res.best.id, res.best.label);
      return;
    }
    // kilka kandydat√≥w ‚Äì poka≈º listƒô
    res.items.slice(0,5).forEach(it=>{
      const row = document.createElement('div');
      row.className = 'bh-ai-result';
      row.innerHTML = `<span><b>${it.label}</b> ‚Ä¢ trafno≈õƒá ${it.score}</span>`;
      const go = document.createElement('button');
      go.className = 'bh-ai-go';
      go.textContent = 'Otw√≥rz';
      go.addEventListener('click', ()=> openPart(typ.value, it.id, it.label));
      row.appendChild(go);
      out.appendChild(row);
    });
  });
})();
</script>
<!-- ========== /AI WYSZUKIWARKA ========== -->
</body>
</html>
