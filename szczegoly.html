<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Szczeg√≥≈Çy</title>

<!-- ====== STYLES (inline; zero zale≈ºno≈õci) ====== -->
<style>
  :root{
    --bg1:#08131a;          /* ciemny turkus/granat */
    --bg2:#120820;          /* ciemny fiolet */
    --tile:#13224e;         /* bazowy kafel  (niebieski) */
    --tile-grad-1:#1b2a62;
    --tile-grad-2:#15234f;
    --tile-border:#5b73ff55;
    --tile-shadow: rgba(0,0,0,.55);
    --white:#eef1ff;
    --muted:#bcd0ff;
    --accent:#7aa6ff;
    --ok:#20c997;           /* ‚ÄûBez recepty‚Äù */
    --warn:#ff5b5b;         /* ‚ÄûNa receptƒô‚Äù + czerwony kafel */
    --pill:#8b7cff;
  }

  /* T≈ÅO: gradient + delikatny wz√≥r */
  body{
    margin:0;
    color:var(--white);
    font: 16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
    background:
      radial-gradient(1200px 800px at 20% 10%, rgba(0,255,255,.10), transparent 60%),
      radial-gradient(900px 700px at 80% 20%, rgba(147,0,255,.12), transparent 55%),
      linear-gradient(135deg, var(--bg1), var(--bg2));
    position:relative;
    min-height:100dvh;
  }
  /* p√≥≈Çprzezroczysty lab-wz√≥r */
  body::before{
    content:"";
    position:fixed; inset:0;
    pointer-events:none;
    opacity:.10;
    background-image:
      radial-gradient(circle at 10% 15%, #7fffd4 1px, transparent 1.2px),
      radial-gradient(circle at 30% 35%, #7aa6ff 1px, transparent 1.2px),
      radial-gradient(circle at 70% 25%, #9f7aff 1.2px, transparent 1.4px),
      radial-gradient(circle at 85% 60%, #7fffd4 1px, transparent 1.2px);
    background-size: 120px 120px, 160px 160px, 180px 180px, 140px 140px;
    background-position: 0 0, 30px 60px, 60px 20px, 90px 100px;
    filter: blur(.2px);
  }

  .wrap{max-width:1180px; margin:18px auto 64px; padding:0 16px;}
  .nav-links{display:flex; gap:16px; align-items:center; margin:8px 0 4px;}
  .nav-links a{color:#6ec2ff; text-decoration:none}
  .nav-links a:hover{text-decoration:underline}
  h1{
    margin:6px 0 18px; text-align:center; font-weight:800;
    letter-spacing:.4px; font-size:clamp(28px, 4.4vw, 44px);
    text-shadow:0 2px 14px rgba(0,0,0,.35);
  }

  /* GRID: zawsze 3 w rzƒôdzie (potem 2/1 na mniejszych) */
  .cards{
    display:grid;
    grid-template-columns: repeat(3, 1fr);
    gap:18px;
    align-items:stretch;
  }
  @media (max-width: 980px){ .cards{ grid-template-columns: repeat(2, 1fr); } }
  @media (max-width: 560px){ .cards{ grid-template-columns: 1fr; } }

  /* KAFEL */
  .card{
    background: linear-gradient(180deg,var(--tile-grad-1),var(--tile-grad-2));
    border:1px solid var(--tile-border);
    border-radius:18px;
    box-shadow:
      inset 0 0 1px rgba(140,160,255,.35),
      0 8px 18px var(--tile-shadow);
    padding:16px 18px 18px;
    transition: transform .18s ease, box-shadow .18s ease, background .18s ease;
  }
  .card:hover{
    transform: translateY(-2px);
    box-shadow:
      inset 0 0 1px rgba(160,180,255,.45),
      0 12px 24px rgba(0,0,0,.6),
      0 0 22px rgba(122,166,255,.18);
  }
  .card h3{
    margin:6px 0 10px; font-size:clamp(18px, 2.2vw, 21px);
    font-weight:800; letter-spacing:.2px; color:#e9ecff;
    display:flex; align-items:center; gap:.5rem;
  }
  .card h3 .em{font-style:normal; color:var(--pill)}
  .card ul{ list-style: disc; list-style-position: inside; padding-left: 0; margin: 6px 0 0; }
  .card li{ margin: 6px 0; }
  .small{ font-size:.92rem; color:var(--muted); }

  /* Wyr√≥≈ºnienia w ‚ÄûLeki‚Äù */
  .rx-free{ color: var(--ok); font-weight:800; }
  .rx{ color: var(--warn); font-weight:800; }

  /* Czerwony kafel (NIEZW≈ÅOCZNA POMOC) */
  .card.emergency{
    background: linear-gradient(180deg, #5a0f12, #3f0b0d);
    border-color: rgba(255,120,120,.55);
    box-shadow:
      inset 0 0 1px rgba(255,140,140,.35),
      0 8px 18px var(--tile-shadow);
  }
  .card.emergency h3 .em{ color:#ffd2d2 }
  .card.emergency:hover{
    box-shadow:
      inset 0 0 1px rgba(255,170,170,.55),
      0 12px 24px rgba(0,0,0,.7),
      0 0 26px rgba(255,70,70,.55);  /* mocny czerwony glow */
  }

  /* ‚Äûpuste‚Äù miejsce ‚Äì gdy jakiej≈õ sekcji brak, trzymamy siatkƒô */
  .spacer{ visibility:hidden; }

  /* komunikat b≈Çƒôdu */
  .error{ display:none; margin:14px 0; color:#ffd1d1; font-weight:700; }
</style>
</head>
<body>
  <div class="wrap">
    <div class="nav-links">
      <a href="index.html">‚Üê Strona g≈Ç√≥wna</a>
      <a id="backLink" href="kobieta.html">‚Üê Wr√≥ƒá do wyboru sekcji</a>
    </div>

    <h1 id="title">Szczeg√≥≈Çy</h1>
    <p id="err" class="error">B≈ÇƒÖd wczytywania danych.</p>

    <section id="grid" class="cards" aria-label="Kafelki szczeg√≥≈Ç√≥w"></section>
  </div>

<!-- ====== SCRIPT (inline; pobiera JSON, rysuje kafelki) ====== -->
<script>
(function(){
  /* --- 0) utiliki --- */
  const $ = sel => document.querySelector(sel);
  const el = (tag, cls, html) => {
    const e = document.createElement(tag);
    if (cls) e.className = cls;
    if (html !== undefined) e.innerHTML = html;
    return e;
  };
  const icon = {
    causes: 'üß¨',
    symptoms: 'ü©∫',
    concerns: '‚ö†Ô∏è',
    doctors: 'üë©‚Äç‚öïÔ∏è',
    medications: 'üíä',
    first_aid: '‚õëÔ∏è',
    avoid: '‚ùå',
    rehab: '‚ú®',
    prevention: 'üß©',
    mistakes: '‚ö†Ô∏è',
    now: '‚û°Ô∏è',
    extra: 'üìò',
    emergency: 'üö®'
  };

  /* --- 1) mapy stron wstecz (kobieta/mƒô≈ºczyzna) --- */
  function backHrefFromId(id){
    if (!id) return 'index.html';
    const female = id.endsWith('_k');
    const male   = id.endsWith('_m');
    const mapF = {
      oczy_k:'kobieta-glowa.html', uszy_k:'kobieta-glowa.html', nos_k:'kobieta-glowa.html',
      szczeka_k:'kobieta-glowa.html', szyja_k:'kobieta-glowa.html', glowa_k:'kobieta-glowa.html',
      serce_k:'kobieta-klatka.html', pluca_k:'kobieta-klatka.html', klatka_piersiowa_k:'kobieta-klatka.html',
      brzuch_k:'kobieta-klatka.html', plecy_k:'kobieta-klatka.html',
      uklad_krw_k:'kobieta-klatka.html', uklad_oddech_k:'kobieta-klatka.html', uklad_pokarm_k:'kobieta-klatka.html',
      biodra_k:'kobieta-nogi.html', uda_k:'kobieta-nogi.html', kolano_k:'kobieta-nogi.html',
      lydka_k:'kobieta-nogi.html', kostka_k:'kobieta-nogi.html', stopy_k:'kobieta-nogi.html',
      ciaza_k:'kobieta.html'
    };
    const mapM = {
      oczy_m:'mezczyzna-glowa.html', uszy_m:'mezczyzna-glowa.html', nos_m:'mezczyzna-glowa.html',
      szczeka_m:'mezczyzna-glowa.html', szyja_m:'mezczyzna-glowa.html', glowa_m:'mezczyzna-glowa.html',
      serce_m:'mezczyzna-klatka.html', pluca_m:'mezczyzna-klatka.html', klatka_piersiowa_m:'mezczyzna-klatka.html',
      brzuch_m:'mezczyzna-klatka.html', plecy_m:'mezczyzna-klatka.html',
      uklad_krw_m:'mezczyzna-klatka.html', uklad_oddech_m:'mezczyzna-klatka.html', uklad_pokarm_m:'mezczyzna-klatka.html',
      biodra_m:'mezczyzna-nogi.html', uda_m:'mezczyzna-nogi.html', kolano_m:'mezczyzna-nogi.html',
      lydka_m:'mezczyzna-nogi.html', kostka_m:'mezczyzna-nogi.html', stopy_m:'mezczyzna-nogi.html'
    };
    if (female) return mapF[id] || 'kobieta.html';
    if (male)   return mapM[id] || 'mezczyzna.html';
    return 'index.html';
  }

  /* --- 2) rysowanie pojedynczego kafla --- */
  function card(title, items, opts = {}){
    const c = el('article', 'card' + (opts.emergency ? ' emergency' : ''));

    const h = el('h3');
    h.innerHTML = (opts.icon ? `<span class="em">${opts.icon}</span> ` : '') + title;
    c.appendChild(h);

    if (Array.isArray(items)){
      const ul = el('ul');
      items.forEach(t => ul.appendChild(el('li', null, t)));
      c.appendChild(ul);
    } else if (typeof items === 'string'){
      c.appendChild(el('p', 'small', items));
    } else if (items === null){
      // SPACER ‚Äì utrzymuje siatkƒô
      c.classList.add('spacer');
    }

    return c;
  }

  /* --- 3) kolejnosc i stabilna siatka 3xN --- */
  const ORDER = [
    'causes','symptoms','concerns',
    'doctors','medications','first_aid',
    'avoid','rehab','prevention',
    'mistakes','now','extra'
  ];
  const FIXED_POS_EMERGENCY = 9; // czerwony kafel na pozycji #10 (liczƒÖc od 0)

  /* --- 4) logika wczytania danych i render --- */
  async function load(){
    const params = new URLSearchParams(location.search);
    const id = params.get('id');
    $('#backLink').href = backHrefFromId(id);

    const err = $('#err');
    try{
      if (!id) throw new Error('Brak parametru id w adresie.');
      const ts = Date.now(); // od≈õwie≈ºenie cache
      // Najpierw bogatszy plik, potem fallback
      const res = await fetch(`data/detailed_conditions.json?ts=${ts}`);
      if (!res.ok) throw new Error('B≈ÇƒÖd pobierania danych.');
      const data = await res.json();
      const node = data[id];
      if (!node) throw new Error('Nie znaleziono wpisu: ' + id);

      $('#title').textContent = node.title || 'Szczeg√≥≈Çy';

      const grid = $('#grid');
      grid.innerHTML = '';

      // 1) Zwyk≈Çe kafle wg ORDER
      ORDER.forEach(key=>{
        if (node[key] && node[key].length){
          let title = '';
          if (key==='causes')       title = 'Mo≈ºliwe przyczyny';
          else if (key==='symptoms')title = 'Objawy';
          else if (key==='concerns')title = 'Kiedy siƒô niepokoiƒá';
          else if (key==='doctors') title = 'Lekarze';
          else if (key==='medications') title = 'Leki';
          else if (key==='first_aid') title = 'Pierwsza pomoc';
          else if (key==='avoid') title = 'Czego unikaƒá';
          else if (key==='rehab') title = 'Rehabilitacja / ƒáwiczenia';
          else if (key==='prevention') title = 'Profilaktyka';
          else if (key==='mistakes') title = 'Najczƒôstsze b≈Çƒôdy';
          else if (key==='now') title = 'Co robiƒá teraz';
          else if (key==='extra') title = 'Dodatkowe informacje';

          // podmiana kolor√≥w w ‚ÄûLeki‚Äù
          let items = node[key];
          if (key==='medications'){
            items = items.map(t=>{
              return t
                .replace(/\bBez recepty\b/i,'<span class="rx-free">Bez recepty</span>')
                .replace(/\bNa receptƒô\b/i,'<span class="rx">Na receptƒô</span>');
            });
          }
          grid.appendChild(card(title, items, {icon: icon[key]}));
        }else{
          // brak sekcji -> wstaw ‚Äûspacer‚Äù aby trzymaƒá rzƒÖd
          grid.appendChild(card('', null));
        }
      });

      // 2) Wstaw awaryjny kafel na sta≈Çe miejsce (zape≈Çnia rzƒÖd 2)
      const emergencyList = (Array.isArray(node.emergency) && node.emergency.length)
        ? node.emergency
        : ['Silny, narastajƒÖcy b√≥l / deformacja / utrata czucia ‚Äî 112/SOR'];

      const em = card('Niezw≈Çoczna pomoc (112/SOR)', emergencyList, {icon: icon.emergency, emergency:true});

      // Je≈õli ju≈º co≈õ stoi na pozycji docelowej -> wstaw przed nim
      const kids = Array.from(grid.children);
      const anchor = kids[FIXED_POS_EMERGENCY];
      if (anchor) grid.insertBefore(em, anchor);
      else grid.appendChild(em);

    }catch(e){
      console.error(e);
      err.style.display='block';
      err.textContent = 'B≈ÇƒÖd: ' + e.message;
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', load);
  } else { load(); }
})();
</script>
</body>
</html>
