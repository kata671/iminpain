<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Szczegóły</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Lekki layout tylko dla tej strony (karty 3 w rzędzie) */
    .cards{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;max-width:1100px;margin:20px auto;padding:0 12px}
    .card{background:rgba(34,42,90,.85);border:1px solid rgba(165,140,255,.25);border-radius:16px;padding:16px;box-shadow:0 4px 12px rgba(0,0,0,.25);transition:box-shadow .2s,transform .2s}
    .card:hover{box-shadow:0 6px 18px rgba(0,0,0,.4);transform:translateY(-3px)}
    .card h3{margin:0 0 8px}
    .card ul{margin:0;padding-left:18px}
    .card p{margin:0}
    .card.emergency{background:rgba(120,8,8,.22);border:1.5px solid #ff3c3c}
    .card.emergency:hover{box-shadow:0 0 25px rgba(255,50,50,.9)}
    @media(max-width:980px){.cards{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:640px){.cards{grid-template-columns:1fr}}
    .nav{max-width:1100px;margin:16px auto 0;padding:0 12px}
    h1#title{max-width:1100px;margin:8px auto 0;padding:0 12px;text-align:center}
    .error{max-width:1100px;margin:18px auto 0;padding:0 12px;color:#ff9}
  </style>
</head>
<body data-page="szczegoly">

  <nav class="nav">
    <a id="sectionBack" href="index.html">← Wróć</a>
  </nav>

  <h1 id="title">Szczegóły</h1>
  <div id="err" class="error" style="display:none"></div>
  <div id="content"></div>

  <footer style="max-width:1100px;margin:24px auto;padding:0 12px;text-align:center;font-size:.9em;color:#aaa">
    © 2025 Iminpain — Materiał poglądowy; nie zastępuje konsultacji z lekarzem.
  </footer>

  <script>
  (function(){
    const $ = sel => document.querySelector(sel);

    // back link – na podstawie sufiksu _k / _m
    function sectionUrlFromId(id){
      if(!id) return 'index.html';
      const female = id.endsWith('_k');
      const male   = id.endsWith('_m');
      const groupMapK = {
        oczy_k:'kobieta-glowa.html', uszy_k:'kobieta-glowa.html', nos_k:'kobieta-glowa.html',
        szczeka_k:'kobieta-glowa.html', szyja_k:'kobieta-glowa.html', glowa_k:'kobieta-glowa.html',
        serce_k:'kobieta-klatka.html', pluca_k:'kobieta-klatka.html', klatka_piersiowa_k:'kobieta-klatka.html',
        brzuch_k:'kobieta-klatka.html', plecy_k:'kobieta-klatka.html',
        uklad_krw_k:'kobieta-klatka.html', uklad_oddech_k:'kobieta-klatka.html', uklad_pokarm_k:'kobieta-klatka.html',
        biodra_k:'kobieta-nogi.html', uda_k:'kobieta-nogi.html', kolano_k:'kobieta-nogi.html',
        lydka_k:'kobieta-nogi.html', kostka_k:'kobieta-nogi.html', stopy_k:'kobieta-nogi.html',
        ciaza_k:'kobieta.html'
      };
      const groupMapM = {
        oczy_m:'mezczyzna-glowa.html', uszy_m:'mezczyzna-glowa.html', nos_m:'mezczyzna-glowa.html',
        szczeka_m:'mezczyzna-glowa.html', szyja_m:'mezczyzna-glowa.html', glowa_m:'mezczyzna-glowa.html',
        serce_m:'mezczyzna-klatka.html', pluca_m:'mezczyzna-klatka.html', klatka_piersiowa_m:'mezczyzna-klatka.html',
        brzuch_m:'mezczyzna-klatka.html', plecy_m:'mezczyzna-klatka.html',
        uklad_krw_m:'mezczyzna-klatka.html', uklad_oddech_m:'mezczyzna-klatka.html', uklad_pokarm_m:'mezczyzna-klatka.html',
        biodra_m:'mezczyzna-nogi.html', uda_m:'mezczyzna-nogi.html', kolano_m:'mezczyzna-nogi.html',
        lydka_m:'mezczyzna-nogi.html', kostka_m:'mezczyzna-nogi.html', stopy_m:'mezczyzna-nogi.html'
      };
      if(female) return groupMapK[id] || 'kobieta.html';
      if(male)   return groupMapM[id] || 'mezczyzna.html';
      return 'index.html';
    }

    function el(tag, className, html){
      const e = document.createElement(tag);
      if(className) e.className = className;
      if(html !== undefined) e.innerHTML = html;
      return e;
    }

    function card(title, items, extraClass){
      const c = el('div', 'card' + (extraClass ? ' '+extraClass : ''));
      c.appendChild(el('h3', null, title));
      if(Array.isArray(items) && items.length){
        const ul = el('ul');
        items.forEach(t => ul.appendChild(el('li', null, t)));
        c.appendChild(ul);
      } else if(typeof items === 'string' && items.trim()){
        c.appendChild(el('p', null, items));
      } else {
        c.appendChild(el('p', null, '<em>Brak danych</em>'));
      }
      return c;
    }

    async function render(){
      const params = new URLSearchParams(location.search);
      const id = params.get('id');

      // ustaw powrót
      $('#sectionBack').href = sectionUrlFromId(id);

      const err = $('#err');
      try{
        if(!id) throw new Error('Brak parametru id w adresie.');

        // ⬇️ KLUCZOWA ZMIANA: korzystamy z detailed_conditions.json
        const res = await fetch('data/detailed_conditions.json?ts=' + Date.now(), { cache:'no-store' });
        if(!res.ok) throw new Error('Błąd pobierania danych (' + res.status + ').');
        const data = await res.json();
        const node = data[id];
        if(!node) throw new Error('Nie znaleziono danych dla: ' + id);

        // tytuł
        $('#title').textContent = node.title || 'Szczegóły';

        // karty
        const grid = el('div','cards');
        grid.appendChild(card('🔎 Możliwe przyczyny bólu', node.causes));
        grid.appendChild(card('🔎 Typowe objawy', node.symptoms));
        grid.appendChild(card('⚠️ Na co zwrócić uwagę (obawy)', node.concerns));
        grid.appendChild(card('👩‍⚕️ Do jakiego lekarza', node.doctors));
        grid.appendChild(card('🚨 Niezwłoczna pomoc (112/SOR)', node.emergency, 'emergency'));
        grid.appendChild(card('💊 Leki / 🆘 Pierwsza pomoc', (node.medications || []).concat(node.first_aid || [])));

        const content = $('#content');
        content.innerHTML = '';
        content.appendChild(grid);

        // opis (jeśli jest)
        if(node.description){
          const desc = el('p', null, node.description);
          desc.style.maxWidth = '1100px';
          desc.style.margin = '16px auto';
          desc.style.padding = '0 12px';
          content.appendChild(desc);
        }

      }catch(e){
        err.style.display = 'block';
        err.textContent = 'Błąd: ' + e.message;
        console.error(e);
      }
    }

    if(document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', render);
    } else {
      render();
    }
  })();
  </script>
</body>
</html>
