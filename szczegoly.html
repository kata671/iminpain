<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Boli Help — Szczegóły</title>
  <meta name="theme-color" content="#0e1230" />
  <style>
    :root{
      --bg:#0e1230; --text:#eef2ff; --muted:#b8c2e0;
      --card: rgba(60,32,100,.30); --stroke: rgba(164,107,255,.18);
      --accent:#a46bff; --pink:#ff6ec7; --teal:#5eead4;
      --ok:#70e1b1; --warn:#ffd16c; --danger:#ff6b6b;
      --radius:16px; --gap:14px; --speed:.24s;
      --c-symptoms: rgba(94,234,212,.55);
      --c-causes:   rgba(164,107,255,.55);
      --c-firstaid: rgba(112,225,177,.55);
      --c-otc:      rgba(255,184,108,.65);
      --c-rx:       rgba(255,107,107,.70);
      --c-rehab:    rgba(94,234,212,.65);
      --c-myths:    rgba(164,107,255,.65);
      --c-faq:      rgba(94,234,212,.55);
      --c-dx:       rgba(164,107,255,.65);
      --c-docs:     rgba(94,234,212,.65);
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0; background:var(--bg); color:var(--text);
      font:15px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Arial;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}

    .bg-anim{position:fixed; inset:0; z-index:-3; pointer-events:none;
      background:
        radial-gradient(42vw 36vh at 16% 12%, rgba(255,110,199,.26), transparent 60%),
        radial-gradient(36vw 30vh at 84% 10%, rgba(94,234,212,.22), transparent 60%),
        radial-gradient(40vw 44vh at 20% 88%, rgba(164,107,255,.16), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,0));
      filter: blur(10px) saturate(118%);
    }
    .grid-bg{position:fixed; inset:0; z-index:-2; pointer-events:none; opacity:.22;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='104' viewBox='0 0 120 104'%3E%3Cg fill='none' stroke='rgba(173,216,255,0.26)' stroke-width='1'%3E%3Cpolygon points='30,0 90,0 120,52 90,104 30,104 0,52'/%3E%3C/g%3E%3C/svg%3E");
      background-size:160px 138px; background-position:center;}
    #bh-particles{ position:fixed; inset:0; z-index:-1; opacity:.85; pointer-events:none }

    header.app{ max-width:1100px; margin:16px auto 0; padding:16px 16px 8px; }
    main{ max-width:1100px; margin:0 auto 72px; padding:0 16px 24px; }

    .bh-backbar{max-width:1100px; margin:8px auto 0; padding:0 16px;}
    #bhReturnTop{
      appearance:none; border:1px solid rgba(164,107,255,.28); background:rgba(60,32,100,.28);
      color:#eef2ff; font-weight:800; letter-spacing:.2px; padding:10px 14px; border-radius:12px; cursor:pointer;
      box-shadow:0 6px 16px rgba(8,10,22,.35), inset 0 0 0 1px rgba(164,107,255,.12), 0 0 8px rgba(164,107,255,.45);
      transition:transform .18s ease, box-shadow .18s ease, border-color .18s ease;
    }
    #bhReturnTop:hover{ transform:translateY(-1px); border-color:rgba(164,107,255,.55); box-shadow:0 10px 20px rgba(8,10,22,.45), 0 0 14px rgba(164,107,255,.65), inset 0 0 0 1px rgba(164,107,255,.18) }
    #bhReturnTop:focus-visible{ outline:2px solid rgba(164,107,255,.75); outline-offset:2px }

    .hero{ background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid var(--stroke); border-radius:var(--radius); padding:16px;
      backdrop-filter: blur(6px) saturate(120%); box-shadow: 0 18px 48px rgba(8,10,22,.55), 0 0 22px rgba(164,107,255,.18);}
    .hero-top{ display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap;}
    .crumbs{font-weight:800; letter-spacing:.2px; color:#cfe2ff}
    .label{ display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px;
      background: rgba(164,107,255,.18); border:1px solid var(--stroke); font-weight:800; letter-spacing:.3px; }
    .hero-note{ margin-top:10px; color:#b8c2e0; font-size:13px; }
    .legend{ color:#d6e4ff; font-weight:700; margin-top:6px; font-size:13px }

    /* KROKI – asystent */
    .steps{display:grid; grid-template-columns:repeat(4,1fr); gap:8px; margin:14px 0 0}
    .step{position:relative; padding:10px 12px; border-radius:12px; border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.05); font-weight:900; letter-spacing:.2px; color:#dfe6ff; text-align:center}
    .step.active{border-color:rgba(94,234,212,.55); box-shadow:0 0 0 2px rgba(94,234,212,.35), 0 8px 18px rgba(8,10,22,.35)}
    .step.done{opacity:.9}
    .step small{display:block; font-weight:700; color:#9fb6ff}

    .tabs{ display:flex; flex-wrap:wrap; gap:8px; margin:16px 0 8px; }
    .tab{ padding:9px 13px; border-radius:10px; font-weight:800; letter-spacing:.2px; cursor:pointer; user-select:none;
      background: transparent; border:1px solid rgba(255,255,255,.16); color:#e9efff;
      transition: box-shadow var(--speed), transform var(--speed), border-color var(--speed), background var(--speed);}
    .tab:hover{ transform: translateY(-1px); }
    .tab[data-variant="symptoms"]{ border-color: rgba(94,234,212,.25) }
    .tab[data-variant="causes"]  { border-color: rgba(164,107,255,.25) }
    .tab[data-variant="firstaid"]{ border-color: rgba(112,225,177,.25) }
    .tab[data-variant="otc"]     { border-color: rgba(255,184,108,.28) }
    .tab[data-variant="rx"]      { border-color: rgba(255,107,107,.35) }
    .tab[data-variant="rehab"]   { border-color: rgba(94,234,212,.28) }
    .tab[data-variant="myths"]   { border-color: rgba(164,107,255,.28) }
    .tab[data-variant="faq"]     { border-color: rgba(94,234,212,.25) }
    .tab[data-variant="dx"]      { border-color: rgba(164,107,255,.45); position:relative }
    .tab[data-variant="docs"]    { border-color: rgba(94,234,212,.45); position:relative }

    .tab[aria-selected="true"][data-variant="symptoms"]{ border-color: var(--c-symptoms); box-shadow:0 0 0 2px var(--c-symptoms), 0 8px 22px rgba(0,0,0,.25) }
    .tab[aria-selected="true"][data-variant="causes"]  { border-color: var(--c-causes);   box-shadow:0 0 0 2px var(--c-causes),   0 8px 22px rgba(0,0,0,.25) }
    .tab[aria-selected="true"][data-variant="firstaid"]{ border-color: var(--c-firstaid); box-shadow:0 0 0 2px var(--c-firstaid), 0 8px 22px rgba(0,0,0,.25) }
    .tab[aria-selected="true"][data-variant="otc"]     { border-color: var(--c-otc);      box-shadow:0 0 0 2px var(--c-otc),      0 8px 22px rgba(0,0,0,.25) }
    .tab[aria-selected="true"][data-variant="rx"]      { border-color: var(--c-rx);       box-shadow:0 0 0 2px var(--c-rx),       0 8px 22px rgba(0,0,0,.25) }
    .tab[aria-selected="true"][data-variant="rehab"]   { border-color: var(--c-rehab);    box-shadow:0 0 0 2px var(--c-rehab),    0 8px 22px rgba(0,0,0,.25) }
    .tab[aria-selected="true"][data-variant="myths"]   { border-color: var(--c-myths);    box-shadow:0 0 0 2px var(--c-myths),    0 8px 22px rgba(0,0,0,.25) }
    .tab[aria-selected="true"][data-variant="faq"]     { border-color: var(--c-faq);      box-shadow:0 0 0 2px var(--c-faq),      0 8px 22px rgba(0,0,0,.25) }
    .tab[aria-selected="true"][data-variant="dx"]      { border-color: var(--c-dx);       box-shadow:0 0 0 2px var(--c-dx),       0 8px 22px rgba(0,0,0,.25) }
    .tab[aria-selected="true"][data-variant="docs"]    { border-color: var(--c-docs);     box-shadow:0 0 0 2px var(--c-docs),     0 8px 22px rgba(0,0,0,.25) }

    .tab[data-badge]:after{
      content: attr(data-badge);
      position:absolute; top:-7px; right:-7px; font-size:11px; font-weight:900;
      background:rgba(94,234,212,.22); border:1px solid rgba(94,234,212,.55); color:#d9fffa;
      padding:2px 6px; border-radius:999px;
    }
    .tab-attn{ box-shadow:0 0 0 2px rgba(164,107,255,.45), 0 0 18px rgba(164,107,255,.28); }
    .tab-attn::before{
      content:""; position:absolute; inset:-6px; border-radius:12px;
      box-shadow:0 0 0 0 rgba(164,107,255,.38); animation:ping 1.6s ease-out infinite;
    }
    @keyframes ping{ 0%{box-shadow:0 0 0 0 rgba(164,107,255,.38)} 80%{box-shadow:0 0 0 14px rgba(164,107,255,0)} 100%{box-shadow:0 0 0 0 rgba(164,107,255,0)} }

    .cards{ margin-top:8px }
    .card{ display:none; background: var(--card); border:1px solid var(--stroke); border-radius:var(--radius);
      padding:16px 16px 14px; backdrop-filter: blur(10px) saturate(125%); box-shadow: 0 14px 34px rgba(8,10,22,.42);
      transition: transform var(--speed), box-shadow var(--speed), border-color var(--speed); color:var(--text); }
    .card[aria-hidden="false"]{ display:block; animation:fadeIn .28s ease both }
    @keyframes fadeIn{ from{opacity:0; transform:translateY(4px)} to{opacity:1; transform:none} }
    .card:hover{ transform: translateY(-2px); box-shadow: 0 18px 48px rgba(8,10,22,.55), 0 0 22px rgba(164,107,255,.18) }
    .card h3{ position:relative; margin:.15rem 0 .85rem; font-size:16px; font-weight:900; letter-spacing:.3px; color:#e6f0ff }
    .card h3::after{ content:""; display:block; height:1px; margin-top:.55rem;
      background:linear-gradient(90deg, rgba(207,226,255,.55), rgba(255,255,255,.08) 45%, transparent); }

    .card[data-type="symptoms"]{border-color: rgba(94,234,212,.55)}
    .card[data-type="causes"]  {border-color: rgba(164,107,255,.55)}
    .card[data-type="firstaid"]{border-color: rgba(112,225,177,.55)}
    .card[data-type="otc"]     {border-color: rgba(255,184,108,.65)}
    .card[data-type="rx"]      {border-color: rgba(255,107,107,.70)}
    .card[data-type="rehab"]   {border-color: rgba(94,234,212,.65); background: linear-gradient(180deg, rgba(94,234,212,.08), rgba(255,255,255,.04));}
    .card[data-type="myths"]   {border-color: rgba(164,107,255,.65)}
    .card[data-type="faq"]     {border-color: rgba(94,234,212,.55)}
    .card[data-type="dx"]      {border-color: rgba(164,107,255,.65)}
    .card[data-type="docs"]    {border-color: rgba(94,234,212,.65)}

    ul.clean{ list-style:none; margin:0; padding:0 }
    ul.clean li{ position:relative; padding:10px 12px 10px 36px; border-radius:10px; margin-bottom:7px;
      border:1px solid rgba(255,255,255,.10); background: rgba(255,255,255,.03); color:#f6f8ff; }
    .cb{ position:absolute; left:10px; top:50%; transform:translateY(-50%); width:18px; height:18px; border-radius:4px;
      border:1px solid rgba(255,255,255,.35); background:rgba(255,255,255,.05); display:inline-block }
    .cb.checked{ background:#fff; box-shadow:0 0 0 2px rgba(164,107,255,.25) inset }
    .li-checked{ outline:1px solid rgba(164,107,255,.45); background: rgba(164,107,255,.10) }

    .more-wrap{ margin-top:10px }
    .more-btn{ display:inline-block; margin-top:8px; padding:10px 14px; border-radius:10px; font-weight:800;
      background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.18); cursor:pointer; color:#e9efff;
      transition: box-shadow var(--speed);}
    .more-btn:hover{ box-shadow:0 0 0 2px rgba(255,110,199,.32), 0 0 14px rgba(255,110,199,.18) }
    .more-content{ overflow:hidden; max-height:0; transition:max-height .3s ease; }
    .more-content.open{ max-height:1200px }

    .subhead{ margin:.9rem 0 .5rem; font-weight:900; color:#e6f0ff; }

    .risk-mini{ display:flex; align-items:center; gap:10px; margin:.15rem 0 .35rem }
    .risk-mini small{ color:#d6e4ff; font-weight:800 }
    .riskbar{ position:relative; width:200px; height:12px; border-radius:999px; overflow:hidden;
      outline:1px solid rgba(255,255,255,.16);
      background: linear-gradient(90deg, var(--ok), var(--warn), var(--danger)); }
    .cursor{ position:absolute; top:50%; transform:translate(-50%,-50%); width:16px; height:16px; border-radius:50%;
      background:#fff; transition:left .25s ease; }
    .riskbar.high .cursor{ animation:pulse 1s infinite }
    @keyframes pulse{ 0%{ box-shadow:0 0 0 0 rgba(255,107,107,.45)} 70%{ box-shadow:0 0 0 14px rgba(255,107,107,0)} 100%{ box-shadow:0 0 0 0 rgba(255,107,107,0)} }
    .strip{ background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      border: 1px solid rgba(255,255,255,.16); padding:.7rem 1rem; border-radius:.8rem; margin:.6rem 0; }
    .strip--warn{ background: linear-gradient(180deg, rgba(255,184,108,.18), rgba(255,255,255,.04)); border-color: rgba(255,184,108,.55); }
    .strip--warn.alert{ box-shadow:0 0 0 2px rgba(255,107,107,.35), 0 10px 28px rgba(255,20,20,.18); border-color: rgba(255,107,107,.8) }
    .cta{ display:inline-block; padding:8px 12px; border-radius:10px; font-weight:900; background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.18); text-decoration:none; color:var(--text); }

    /* HINT w Objawach */
    .dx-hint{ display:none; margin-top:10px; border-radius:10px; padding:10px 12px;
      background:rgba(164,107,255,.12); border:1px solid rgba(164,107,255,.35); color:#e9e6ff; }
    .dx-hint.show{ display:block }
    .dx-hint button{ margin-left:8px; padding:8px 10px; border-radius:10px; font-weight:900; cursor:pointer;
      background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.18); color:#fff }

    /* Choroby – dopasowania */
    .dx-list li{ display:flex; gap:10px; align-items:flex-start; }
    .dx-ico{ width:22px; height:22px; display:grid; place-items:center; border-radius:6px;
      background:rgba(164,107,255,.18); border:1px solid rgba(164,107,255,.35) }
    .dx-meta{ margin-left:auto; display:flex; flex-direction:column; align-items:flex-end; gap:6px; min-width:160px }
    .conf-wrap{ width:120px; height:8px; border-radius:999px; outline:1px solid rgba(255,255,255,.16); overflow:hidden;
      background:linear-gradient(90deg, rgba(94,234,212,.25), rgba(164,107,255,.25)); }
    .conf-bar{ height:100%; width:0%; background:linear-gradient(90deg, rgba(94,234,212,.65), rgba(164,107,255,.65)) }
    .dx-badge{ font-size:12px; padding:4px 8px; border-radius:999px; font-weight:900; letter-spacing:.2px; }
    .dx-badge.poz{ background:rgba(94,234,212,.18); border:1px solid rgba(94,234,212,.45); color:#d9fffa }
    .dx-badge.sor{ background:rgba(255,107,107,.20); border:1px solid rgba(255,107,107,.65); color:#ffe6e6 }
    .dx-note{ color:#cfe2ff; font-size:13px; margin:.15rem 0 .35rem }
    .dx-match{ font-size:12px; color:#cfe2ff; margin-top:6px }

    /* Lekarze */
    .docs-note{ color:#cfe2ff; font-size:13px; margin:.15rem 0 .35rem }
    .doc-badge{ font-size:12px; padding:4px 8px; border-radius:999px; font-weight:900; letter-spacing:.2px; }
    .doc-badge.poz{ background:rgba(94,234,212,.18); border:1px solid rgba(94,234,212,.45); color:#d9fffa }
    .doc-badge.sor{ background:rgba(255,107,107,.20); border:1px solid rgba(255,107,107,.65); color:#ffe6e6 }
    .doc-cta{ margin-top:6px; display:inline-block; padding:8px 10px; border-radius:10px; font-weight:900;
      background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.18); color:#fff; text-decoration:none; }

    .sr-only{ position:absolute !important; left:-9999px !important; }

    /* ===== WYGLĄD SELEKTORA JĘZYKA — poprawki mobile/safe-area ===== */
    .langpick{
      position:fixed;
      top:clamp(8px, env(safe-area-inset-top, 8px), 20px);
      right:12px; z-index:10000;
      display:flex; gap:8px; align-items:center;
      background:rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.24);
      border-radius:12px; padding:6px 10px; backdrop-filter:saturate(120%) blur(4px);
      max-width:100%; white-space:nowrap; contain:layout;
    }
    .langpick label{font-weight:800;color:#cfe2ff;font-size:13px}
    .langpick select{
      appearance:none;background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.24);
      color:#ffffff; border-radius:10px;padding:6px 10px;cursor:pointer;font-weight:900;letter-spacing:.3px;
      max-width:52vw;
    }
    .langpick option{ color:#0e1230; background:#ffffff }

    @media (max-width:560px){
      body{ padding-top: calc(48px + env(safe-area-inset-top, 0px)); }
      .langpick{
        left:50%; right:auto; transform:translateX(-50%);
        gap:6px; padding:5px 8px;
      }
      .langpick label{ display:none; }
      .langpick select{ font-size:12px; padding:5px 9px; }
      .container header.header{ margin-top:8px; }
    }

    /* Ukryj ewentualne resztki starego GT */
    .goog-te-banner-frame.skiptranslate{display:none!important}
    .skiptranslate,.goog-te-gadget,.goog-te-combo,[id*="google_translate_element"]{display:none!important}
  </style>
</head>
<body>
  <div class="bg-anim" aria-hidden="true"></div>
  <div class="grid-bg" aria-hidden="true"></div>
  <canvas id="bh-particles" aria-hidden="true"></canvas>

  <!-- SELEKTOR JĘZYKA (prawy górny róg) -->
  <div class="langpick" id="bhLangPick" aria-label="Wybór języka">
    <label for="bhLangSelect">Język</label>
    <select id="bhLangSelect">
      <option value="pl">PL</option>
      <option value="en">EN</option>
    </select>
  </div>

  <div class="bh-backbar">
    <button id="bhReturnTop" type="button" aria-label="Wróć do poprzedniej strony">← Wróć</button>
  </div>

  <header class="app" aria-label="Nawigacja lokalna">
    <div class="hero" role="region" aria-label="Nagłówek szczegółów">
      <div class="hero-top">
        <div class="crumbs" id="crumbs">Boli Help / <span id="crumb-typ">—</span> / <span id="crumb-label">Szczegóły</span></div>
        <div class="label"><span id="label-icon" aria-hidden="true">●</span><span id="label-text"><b>—</b></span></div>
      </div>

      <!-- KROKI -->
      <div class="steps" aria-label="Asystent kroków">
        <div class="step" id="step-1">1. Objawy<small>Zaznacz</small></div>
        <div class="step" id="step-2">2. Choroby<small>Zobacz podpowiedzi</small></div>
        <div class="step" id="step-3">3. Lekarze<small>Gdzie iść?</small></div>
        <div class="step" id="step-4">4. Co dalej<small>112/SOR lub dom</small></div>
      </div>

      <div class="tabs" role="tablist" aria-label="Sekcje treści">
        <button class="tab" data-variant="symptoms" role="tab" aria-selected="true"  data-target="#s-objawy">Objawy</button>
        <button class="tab" data-variant="causes"   role="tab" aria-selected="false" data-target="#s-przyczyny">Przyczyny</button>
        <button class="tab" data-variant="firstaid" role="tab" aria-selected="false" data-target="#s-aid">Pierwsza pomoc</button>
        <button class="tab" data-variant="otc"      role="tab" aria-selected="false" data-target="#s-otc">Leki OTC</button>
        <button class="tab" data-variant="rx"       role="tab" aria-selected="false" data-target="#s-rx">Leki na receptę</button>
        <button class="tab" data-variant="rehab"    role="tab" aria-selected="false" data-target="#s-rehab">Rehabilitacja / Profilaktyka</button>
        <button class="tab" data-variant="myths"    role="tab" aria-selected="false" data-target="#s-mity">Mity vs Fakty</button>
        <button class="tab" data-variant="faq"      role="tab" aria-selected="false" data-target="#s-faq">FAQ</button>
        <button class="tab" data-variant="dx"       role="tab" aria-selected="false" data-target="#s-dx">Choroby (beta)</button>
        <button class="tab" data-variant="docs"     role="tab" aria-selected="false" data-target="#s-docs">Lekarze</button>
      </div>

      <p class="hero-note">Edukacyjnie, nie diagnostycznie. W nagłej, ciężkiej dolegliwości lub przy czerwonych flagach — skorzystaj z <b>112</b> lub SOR.</p>
      <p class="legend">Zaznacz <strong>objawy</strong> — pasek <b>Ryzyko</b> oraz karty <b>Choroby</b>/<b>Lekarze</b> dopasują się automatycznie.</p>
    </div>
  </header>

  <main>
    <section class="cards" aria-label="Karty z informacjami szczegółowymi">
      <!-- OBJAWY -->
      <article class="card" data-type="symptoms" id="s-objawy" aria-labelledby="h-obj" role="tabpanel" aria-hidden="false">
        <h3 id="h-obj">Objawy</h3>
        <ul class="clean" id="symp-common"></ul>
        <div class="more-wrap" id="mw-symp-common" hidden>
          <div class="more-content" id="mc-symp-common"></div>
          <button class="more-btn" data-more="symp-common">Pokaż więcej</button>
        </div>

        <div class="subhead">Kiedy się niepokoić (czerwone flagi)</div>
        <div class="risk-mini" aria-label="Szacowany poziom ryzyka">
          <small>Ryzyko: <span id="risk-label">niskie</span></small>
          <span class="riskbar" id="riskbar"><span class="cursor" id="risk-cursor-card" style="left:0%"></span></span>
        </div>
        <ul class="clean" id="urgent"></ul>
        <div class="more-wrap" id="mw-urgent" hidden>
          <div class="more-content" id="mc-urgent"></div>
          <button class="more-btn" data-more="urgent">Pokaż więcej</button>
        </div>
        <div class="strip strip--warn" id="urgent-strip">
          Masz objawy alarmowe? <strong>Nie zwlekaj.</strong>
          <a class="cta" id="cta-112" href="tel:112" aria-label="Zadzwoń na numer alarmowy 112">Zadzwoń 112</a>
        </div>

        <!-- HINT po zaznaczeniu objawów -->
        <div id="dx-hint" class="dx-hint" role="status" aria-live="polite">
          Masz zaznaczone objawy. Zobacz edukacyjne podpowiedzi w <strong>Choroby</strong> lub przejdź do <strong>Lekarze</strong>.
          <button type="button" id="dx-open">Choroby</button>
          <button type="button" id="docs-open">Lekarze</button>
        </div>
      </article>

      <!-- PRZYCZYNY -->
      <article class="card" data-type="causes" id="s-przyczyny" role="tabpanel" aria-hidden="true">
        <h3 id="h-cause">Przyczyny</h3>
        <ul class="clean" id="causes"></ul>
        <div class="more-wrap" id="mw-causes" hidden>
          <div class="more-content" id="mc-causes"></div>
          <button class="more-btn" data-more="causes">Pokaż więcej</button>
        </div>
      </article>

      <!-- PIERWSZA POMOC -->
      <article class="card" data-type="firstaid" id="s-aid" role="tabpanel" aria-hidden="true">
        <h3 id="h-aid">Pierwsza pomoc</h3>
        <ul class="clean" id="firstaid"></ul>
        <div class="more-wrap" id="mw-firstaid" hidden>
          <div class="more-content" id="mc-firstaid"></div>
          <button class="more-btn" data-more="firstaid">Pokaż więcej</button>
        </div>
      </article>

      <!-- OTC -->
      <article class="card" data-type="otc" id="s-otc" role="tabpanel" aria-hidden="true">
        <h3 id="h-otc">Leki bez recepty (OTC)</h3>
        <ul class="clean" id="meds-otc"></ul>
        <div class="more-wrap" id="mw-meds-otc" hidden>
          <div class="more-content" id="mc-meds-otc"></div>
          <button class="more-btn" data-more="meds-otc">Pokaż więcej</button>
        </div>
      </article>

      <!-- RX -->
      <article class="card" data-type="rx" id="s-rx" role="tabpanel" aria-hidden="true">
        <h3 id="h-rx">Leki na receptę (informacyjnie)</h3>
        <ul class="clean" id="meds-rx"></ul>
        <div class="more-wrap" id="mw-meds-rx" hidden>
          <div class="more-content" id="mc-meds-rx"></div>
          <button class="more-btn" data-more="meds-rx">Pokaż więcej</button>
        </div>
      </article>

      <!-- REHAB -->
      <article class="card" data-type="rehab" id="s-rehab" role="tabpanel" aria-hidden="true">
        <h3 id="h-rehab">Rehabilitacja / Profilaktyka</h3>
        <ul class="clean" id="rehab"></ul>
        <div class="more-wrap" id="mw-rehab" hidden>
          <div class="more-content" id="mc-rehab"></div>
          <button class="more-btn" data-more="rehab">Pokaż więcej</button>
        </div>
      </article>

      <!-- MITY -->
      <article class="card" data-type="myths" id="s-mity" role="tabpanel" aria-hidden="true">
        <h3 id="h-mity">Mity vs Fakty</h3>
        <ul class="clean" id="myths"></ul>
      </article>

      <!-- FAQ -->
      <article class="card" data-type="faq" id="s-faq" role="tabpanel" aria-hidden="true">
        <h3 id="h-faq">FAQ</h3>
        <ul class="clean" id="faq"></ul>
      </article>

      <!-- CHOROBY -->
      <article class="card" data-type="dx" id="s-dx" role="tabpanel" aria-hidden="true">
        <h3 id="h-dx">Choroby (beta)</h3>
        <p class="dx-note">Podpowiedzi edukacyjne z zaznaczonych objawów. Nie zastępują konsultacji.</p>
        <ul class="clean dx-list" id="dx-list"></ul>
      </article>

      <!-- LEKARZE -->
      <article class="card" data-type="docs" id="s-docs" role="tabpanel" aria-hidden="true">
        <h3 id="h-docs">Lekarze</h3>
        <p class="docs-note">Kolejność: <b>POZ</b> (lekarz rodzinny) → specjaliści powiązani z problemem. Czerwone flagi kierują do <b>SOR/112</b>.</p>
        <ul class="clean" id="docs-list"></ul>
      </article>
    
<div class="card fade-in" id="statystyki">
  <h3>📊 Statystyki i ciekawostki medyczne</h3>
  <ul class="checklist">
    <li>✅ Ponad 70% przypadków bólu brzucha ma podłoże funkcjonalne, nie chorobowe.</li>
    <li>✅ Mężczyźni zgłaszają objawy o 40% rzadziej niż kobiety – mimo podobnych dolegliwości.</li>
    <li>✅ Stres odpowiada nawet za 60% zgłoszeń bólowych bez uszkodzeń fizycznych.</li>
    <li>✅ Aż 90% pacjentów szuka objawów w internecie przed wizytą u lekarza.</li>
    <li>✅ Tylko 1 na 10 przypadków bólu klatki piersiowej to faktyczny zawał serca.</li>
    <li>✅ Objawy psychiczne (lęk, panika) mogą dawać silne objawy somatyczne: ból serca, duszności.</li>
    <li>✅ Ból lewej ręki to tylko jeden z wielu objawów zawału – ważny jest kontekst!</li>
    <li>✅ Większość dzieci z bólem brzucha nie wymaga interwencji – to stres lub dieta.</li>
  </ul>
</div>

<style>
  .fade-in { animation: fadeInUp 1s ease-in-out; }
  @keyframes fadeInUp { from { opacity:0; transform:translateY(20px);} to { opacity:1; transform:translateY(0);} }
  .card#statystyki {
    background: rgba(20, 30, 60, 0.95);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 16px;
    padding: 1.8rem; margin-bottom: 2rem;
    box-shadow: 0 0 16px rgba(48,213,200,0.4);
  }
  .card#statystyki h3 { color:#30d5c8; font-size:1.5rem; margin-bottom:1rem; }
  .card#statystyki ul.checklist { list-style:none; padding:0; margin:0; }
  .card#statystyki ul.checklist li {
    margin-bottom:.75rem; font-size:1.05rem; line-height:1.5;
    position:relative; padding-left:1.6rem; color:#ffffff;
  }
  .card#statystyki ul.checklist li::before {
    content:'✔'; position:absolute; left:0; color:#7fffd4; font-weight:bold;
  }
</style>

    </section>
  </main>
  <script>
    /* =========================
       JĘZYK — wspólny z całą witryną
       ========================= */
    (function langInit(){
      const KEY='bh.lang';
      const get = ()=> localStorage.getItem(KEY) || 'pl';
      const set = (v)=> { localStorage.setItem(KEY, v); };
      window.__getLang = get;
      const sel = document.getElementById('bhLangSelect');
      if(sel){
        sel.value = get();
        sel.addEventListener('change', ()=>{
          set(sel.value||'pl');
          // przeładowanie, by użyć odpowiednich treści
          location.replace(location.href);
        });
      }
    })();

    /* =========================
       I18N — UI statyczny
       ========================= */
    const I18N = {
      pl:{
        lang_label:'Język', back:'← Wróć',
        hero_note:'Edukacyjnie, nie diagnostycznie. W nagłej, ciężkiej dolegliwości lub przy czerwonych flagach — skorzystaj z <b>112</b> lub SOR.',
        legend:'Zaznacz <strong>objawy</strong> — pasek <b>Ryzyko</b> oraz karty <b>Choroby</b>/<b>Lekarze</b> dopasują się automatycznie.',
        steps:['1. Objawy','2. Choroby','3. Lekarze','4. Co dalej'],
        stepsSub:['Zaznacz','Zobacz podpowiedzi','Gdzie iść?','112/SOR lub dom'],
        tabs:{
          symptoms:'Objawy', causes:'Przyczyny', firstaid:'Pierwsza pomoc',
          otc:'Leki OTC', rx:'Leki na receptę', rehab:'Rehabilitacja / Profilaktyka',
          myths:'Mity vs Fakty', faq:'FAQ', dx:'Choroby (beta)', docs:'Lekarze'
        },
        symptoms_head:'Objawy',
        urgent_head:'Kiedy się niepokoić (czerwone flagi)',
        risk:'Ryzyko:', risk_low:'niskie', risk_mid:'umiarkowane', risk_high:'wysokie',
        show_more:'Pokaż więcej', show_less:'Pokaż mniej',
        urgent_strip:'Masz objawy alarmowe? <strong>Nie zwlekaj.</strong>',
        call_112:'Zadzwoń 112',
        hint:'Masz zaznaczone objawy. Zobacz edukacyjne podpowiedzi w <strong>Choroby</strong> lub przejdź do <strong>Lekarze</strong>.',
        hint_btn_dx:'Choroby', hint_btn_docs:'Lekarze',
        h_cause:'Przyczyny', h_aid:'Pierwsza pomoc',
        h_otc:'Leki bez recepty (OTC)', h_rx:'Leki na receptę (informacyjnie)',
        h_rehab:'Rehabilitacja / Profilaktyka', h_myths:'Mity vs Fakty',
        h_faq:'FAQ', h_dx:'Choroby (beta)', h_docs:'Lekarze',
        dx_note:'Podpowiedzi edukacyjne z zaznaczonych objawów. Nie zastępują konsultacji.',
        crumbs_details:'Szczegóły',
        // Statystyki
        stats_h:'📊 Statystyki i ciekawostki medyczne',
        stats:[
          '✅ Ponad 70% przypadków bólu brzucha ma podłoże funkcjonalne, nie chorobowe.',
          '✅ Mężczyźni zgłaszają objawy o 40% rzadziej niż kobiety – mimo podobnych dolegliwości.',
          '✅ Stres odpowiada nawet za 60% zgłoszeń bólowych bez uszkodzeń fizycznych.',
          '✅ Aż 90% pacjentów szuka objawów w internecie przed wizytą u lekarza.',
          '✅ Tylko 1 na 10 przypadków bólu klatki piersiowej to faktyczny zawał serca.',
          '✅ Objawy psychiczne (lęk, panika) mogą dawać silne objawy somatyczne: ból serca, duszności.',
          '✅ Ból lewej ręki to tylko jeden z wielu objawów zawału – ważny jest kontekst!',
          '✅ Większość dzieci z bólem brzucha nie wymaga interwencji – to stres lub dieta.'
        ],
        // Doktor CTA
        prep_visit:'Jak się przygotować na wizytę?',
        prep_alert:'Zbierz: listę objawów i czas trwania, leki, choroby przewlekłe, alergie, pomiary (temp./ciśnienie), wyniki badań.',
        find_er:'Znajdź SOR w pobliżu', find_pharmacy:'Znajdź aptekę 24h',
        badge_poz:'POZ', badge_sor:'pilnie SOR', badge_doc:'POZ/specjalista'
      },
      en:{
        lang_label:'Language', back:'← Back',
        hero_note:'Educational, not diagnostic. If symptoms are severe or you see red flags — use <b>112</b> or the ER.',
        legend:'Select <strong>symptoms</strong> — the <b>Risk</b> bar and <b>Conditions</b>/<b>Doctors</b> cards will auto-adjust.',
        steps:['1. Symptoms','2. Conditions','3. Doctors','4. Next'],
        stepsSub:['Select','See hints','Where to go?','112/ER or home'],
        tabs:{
          symptoms:'Symptoms', causes:'Causes', firstaid:'First aid',
          otc:'OTC medicines', rx:'Prescription (info)', rehab:'Rehab / Prevention',
          myths:'Myths vs Facts', faq:'FAQ', dx:'Conditions (beta)', docs:'Doctors'
        },
        symptoms_head:'Symptoms',
        urgent_head:'When to worry (red flags)',
        risk:'Risk:', risk_low:'low', risk_mid:'moderate', risk_high:'high',
        show_more:'Show more', show_less:'Show less',
        urgent_strip:'Alarm signs? <strong>Don’t wait.</strong>',
        call_112:'Call 112',
        hint:'You selected symptoms. See educational hints in <strong>Conditions</strong> or open <strong>Doctors</strong>.',
        hint_btn_dx:'Conditions', hint_btn_docs:'Doctors',
        h_cause:'Causes', h_aid:'First aid',
        h_otc:'Over-the-counter (OTC)', h_rx:'Prescription medicines (info)',
        h_rehab:'Rehab / Prevention', h_myths:'Myths vs Facts',
        h_faq:'FAQ', h_dx:'Conditions (beta)', h_docs:'Doctors',
        dx_note:'Educational suggestions from your selected symptoms. Not a diagnosis.',
        crumbs_details:'Details',
        stats_h:'📊 Medical stats & curiosities',
        stats:[
          '✅ Over 70% of abdominal pain cases are functional rather than disease-based.',
          '✅ Men report symptoms ~40% less often than women despite similar issues.',
          '✅ Stress accounts for up to 60% of pain reports without tissue damage.',
          '✅ About 90% of patients search symptoms online before seeing a doctor.',
          '✅ Only ~1 in 10 chest-pain cases is an actual heart attack.',
          '✅ Anxiety/panic can produce strong bodily symptoms: chest pain, shortness of breath.',
          '✅ Left-arm pain is just one of many heart-attack signs — context matters!',
          '✅ Most children with belly pain don’t need intervention — often stress or diet.'
        ],
        prep_visit:'How to prepare for a visit?',
        prep_alert:'Bring: list of symptoms and duration, medications, chronic diseases, allergies, measurements (temp./BP), test results.',
        find_er:'Find ER near me', find_pharmacy:'Find 24h pharmacy',
        badge_poz:'GP/Primary care', badge_sor:'urgent ER', badge_doc:'GP/specialist'
      }
    };
    const L = ()=> (window.__getLang && window.__getLang()) || 'pl';

    /* =========================
       DANE KONTENTU (PL/EN)
       ========================= */
    const BASE = {
      pl:{
        rehabCommon:["Sen i regeneracja — 7–9 h","Nawodnienie — małe porcje","Lekka aktywność 20–30 min","Ergonomia — przerwy co 30–45 min","Oddech przeponowy — 5 min","Higiena cyfrowa — 20-20-20"],
        otcPain:[{t:"Paracetamol — ból/gorączka",audience:"all"},{t:"Ibuprofen — ból/zapalenie (nie przy wrzodach/ciąży)",audience:"adult"},{t:"Sól fizjologiczna/nawilżanie",audience:"all"},{t:"Przeciwhistaminowe — po konsultacji",audience:"all"}],
        urgentCommon:["Nagła, silna, narastająca dolegliwość","Utrata przytomności/drgawki","Trudności w oddychaniu lub sinica","Krwawienie nie do opanowania","Gorączka >39°C mimo leczenia","Nowe objawy neurologiczne"],
        mythsCommon:[{m:"Antybiotyk na przeziębienie",f:"Większość przeziębień to wirusy."},{m:"Ból trzeba przeczekać",f:"Nawodnienie i odpoczynek pomagają."},{m:"Im więcej leków, tym lepiej",f:"Lepiej mniej, ale właściwie dobranych."}],
        faqCommon:[{q:"Co w domu?",a:"Pierwsza pomoc + obserwacja czerwonych flag."},{q:"Kiedy do lekarza?",a:"Gdy silne/utrzymujące się 48–72h lub flagi."},{q:"Łączenie OTC?",a:"Nie duplikuj substancji czynnych."}]
      },
      en:{
        rehabCommon:["Sleep & recovery — 7–9 h","Hydration — small sips","Light activity 20–30 min","Ergonomics — breaks every 30–45 min","Diaphragmatic breathing — 5 min","Digital hygiene — 20-20-20"],
        otcPain:[{t:"Paracetamol — pain/fever",audience:"all"},{t:"Ibuprofen — pain/inflammation (avoid in ulcers/pregnancy)",audience:"adult"},{t:"Saline / humidification",audience:"all"},{t:"Antihistamines — after advice",audience:"all"}],
        urgentCommon:["Sudden, severe, worsening symptoms","Loss of consciousness/seizures","Breathing difficulty or cyanosis","Uncontrolled bleeding","Fever >39°C despite therapy","New neurological symptoms"],
        mythsCommon:[{m:"Antibiotics for a cold",f:"Most colds are viral."},{m:"You should just endure pain",f:"Hydration and rest help."},{m:"More meds = better",f:"Better fewer, well-chosen."}],
        faqCommon:[{q:"What to do at home?",a:"First aid + watch for red flags."},{q:"When to see a doctor?",a:"If severe/persistent 48–72h or red flags."},{q:"Mixing OTC drugs?",a:"Don’t duplicate active ingredients."}]
      }
    };

    // Treści części ciała PL
    const CONTENT_PL = { /* ... (bez zmian — pełen blok jak w Twoim pliku) ... */ };

    // Treści EN
    const CONTENT_EN = { /* ... (bez zmian — pełen blok jak w Twoim pliku) ... */ };

    // Diagnostyka/choroby — nazwy/advice w 2 językach
    const DX_RULES = { /* ... (bez zmian — pełen blok jak w Twoim pliku) ... */ };

    /* =========================
       LOGIKA PLIKÓW (router + render)
       ========================= */

    /* Wróć + start od góry */
    try{ if('scrollRestoration' in history){ history.scrollRestoration = 'manual'; } }catch(e){}
    window.addEventListener('DOMContentLoaded', function(){
      window.scrollTo(0,0);
      document.getElementById('bhReturnTop')?.addEventListener('click', function(){
        if (document.referrer && document.referrer.includes(location.host)) history.back();
        else window.location.href = 'index.html';
      });
    });

    /* Router & parametry */
    const qs = new URLSearchParams(location.search);
    const RAW_TYP   = (qs.get('typ')||'kobieta').toLowerCase();
    const RAW_CZESC = (qs.get('czesc')||'glowa').toLowerCase();
    const RAW_LABEL = (qs.get('label')||RAW_CZESC).toString();

    const ALIAS = { 'oko':'oczy','klatka-piersiowa':'klatka','watroba':'brzuch','zoladek':'brzuch','ramie':'plecy','dłoń':'plecy','dlon':'plecy','udo':'biodra' };
    const TYP = RAW_TYP; const CZESC = ALIAS[RAW_CZESC] || RAW_CZESC; const LABEL = RAW_LABEL;

    // Ustaw okruszki
    (function setCrumbs(){
      const l=L(); const dict=I18N[l];
      document.getElementById('crumb-typ').textContent = TYP;
      document.getElementById('crumb-label').textContent = dict.crumbs_details;
    })();

    /* Kroki */
    const stepEls = [null, document.getElementById('step-1'), document.getElementById('step-2'), document.getElementById('step-3'), document.getElementById('step-4')];
    function activateStep(n){
      stepEls.forEach((el,i)=>{ if(!el) return; el.classList.toggle('active', i===n); el.classList.toggle('done', i<n); });
    }
    activateStep(1);

    /* Render zakładek + keyboard nav */
    const tabs = Array.from(document.querySelectorAll('.tab'));
    const panels = Array.from(document.querySelectorAll('.card[role="tabpanel"]'));
    function showPanel(targetSel){
      panels.forEach(p=>{ const active = ('#'+p.id)===targetSel; p.setAttribute('aria-hidden', active? 'false':'true'); });
      tabs.forEach(t=>{ const on = t.getAttribute('data-target')===targetSel; t.setAttribute('aria-selected', on?'true':'false'); if(on) t.focus({preventScroll:true}); });
      document.querySelector(targetSel)?.scrollIntoView({behavior:'smooth', block:'start'});
      if(targetSel==='#s-objawy') activateStep(1);
      if(targetSel==='#s-dx')     activateStep(2);
      if(targetSel==='#s-docs')   activateStep(3);
    }
    tabs.forEach(t=>{
      t.addEventListener('click', ()=> showPanel(t.getAttribute('data-target')));
      t.addEventListener('keydown', e=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); t.click(); } });
    });
    (function tabsKeyboard(){
      const order = tabs;
      tabs.forEach((t,i)=>{
        t.addEventListener('keydown',e=>{
          if(e.key==='ArrowRight'){ e.preventDefault(); order[(i+1)%order.length].focus(); }
          if(e.key==='ArrowLeft'){ e.preventDefault(); order[(i-1+order.length)%order.length].focus(); }
        });
      });
    })();

    /* ===== Kontent wg języka ===== */
    const CONTENT = (L()==='en') ? CONTENT_EN : CONTENT_PL;
    const BASE_CUR = (L()==='en') ? BASE.en : BASE.pl;
    const FALLBACK = { label: LABEL || CZESC, risk: 0, ...CONTENT.glowa };
    const entry = CONTENT[CZESC] || FALLBACK;
    document.getElementById('label-text').innerHTML = '<b>'+ (entry.label||LABEL) + '</b> • ' + TYP;

    /* ===== Risk/score ===== */
    const isChild = (TYP === 'dziecko');
    const allowItem = (item)=>{ if(typeof item==='string') return true; const aud=(item.audience||'all'); return isChild ? aud!=='adult' : aud!=='child'; };
    const textOf = (item)=> typeof item === 'string' ? item : item.t;

    const HIGH_RISK_PHRASES_PL=["duszność","sinica","utrata przytomności","krwawienie","nagła","najgorszy ból","omdlenie","krwioplucie","twardy brzuch"];
    const MID_RISK_PHRASES_PL =["gorączka","sztywność karku","silny ból","utrzymujące się","zaburzenia widzenia","zawroty"];
    const HIGH_RISK_PHRASES_EN=["dyspnea","cyanosis","loss of consciousness","bleeding","sudden","thunderclap","syncope","hemoptysis","rigid abdomen"];
    const MID_RISK_PHRASES_EN =["fever","neck stiffness","severe pain","persistent","vision disturbances","dizziness"];

    function phrases(){ return (L()==='en')
      ? {H:HIGH_RISK_PHRASES_EN, M:MID_RISK_PHRASES_EN}
      : {H:HIGH_RISK_PHRASES_PL, M:MID_RISK_PHRASES_PL}; }

    function weightFor(text,bucket){
      const s=(text||"").toLowerCase();
      if(bucket==='urgent') return 35;
      const P=phrases();
      if(P.H.some(k=>s.includes(k))) return 20;
      if(P.M.some(k=>s.includes(k)))  return 10;
      if(bucket==='symptoms') return 6;
      return 0;
    }

    // pamięć wyborów
    const MEMO_KEY = `bh:symptoms:${TYP}:${CZESC}`;
    function saveSelections(){
      try{
        const selected = Array.from(document.querySelectorAll('#symp-common li.li-checked')).map(li=>li.textContent.trim());
        const urgent   = Array.from(document.querySelectorAll('#urgent li.li-checked')).map(li=>li.textContent.trim());
        localStorage.setItem(MEMO_KEY, JSON.stringify({selected, urgent}));
      }catch(_){}
    }
    function restoreSelections(){
      try{
        const raw = localStorage.getItem(MEMO_KEY); if(!raw) return;
        const data = JSON.parse(raw)||{};
        const mark = (ulId, texts=[])=>{
          const lis = Array.from(document.querySelectorAll(`#${ulId} li`));
          lis.forEach(li=>{
            const txt = li.textContent.trim();
            if(texts.includes(txt)){
              const cb = li.querySelector('.cb');
              if(!cb.classList.contains('checked')) cb.click();
            }
          });
        };
        mark('symp-common', data.selected||[]);
        mark('urgent', data.urgent||[]);
      }catch(_){}
    }

    let selectedWeights=0, selectedCount=0;

    function updateRisk(){
      const dict=I18N[L()];
      const base=0;
      const val =Math.max(0,Math.min(100,base+selectedWeights));
      const c=document.getElementById('risk-cursor-card');
      const bar=document.getElementById('riskbar');
      const lbl=document.getElementById('risk-label');
      if(c){ c.style.left = val + '%'; }
      if(lbl){
        let t=dict.risk_low; if(val>=70) t=dict.risk_high; else if(val>=40) t=dict.risk_mid; lbl.textContent=t;
      }
      if(bar){
        const high=val>=70; bar.classList.toggle('high',high);
        const strip=document.getElementById('urgent-strip'); const cta=document.getElementById('cta-112');
        strip?.classList.toggle('alert',high); cta?.classList.toggle('cta-alert',high);
        if(high && navigator.vibrate){ try{ navigator.vibrate(120);}catch(_){} }
      }
      const hint = document.getElementById('dx-hint');
      const dxTab = document.querySelector('.tab[data-variant="dx"]');
      const docsTab = document.querySelector('.tab[data-variant="docs"]');
      const dxMatches = computeDx().filter(x=>x._score>0 || x.badge==='sor').length;
      const docsMatches = computeDocs().length;
      hint?.classList.toggle('show', selectedCount>0);
      if(dxTab){ dxTab.classList.toggle('tab-attn', selectedCount>0); dxTab.setAttribute('data-badge', selectedCount>0 ? String(dxMatches) : ''); }
      if(docsTab){ docsTab.classList.toggle('tab-attn', selectedCount>0); docsTab.setAttribute('data-badge', selectedCount>0 ? String(docsMatches) : ''); }
      activateStep(selectedCount>0 ? 2 : 1);
    }
    /* Renderery list */
    function renderListInteractive(baseId,arr,bucket,threshold=7){
      const list=document.getElementById(baseId);
      const wrap=document.getElementById('mw-'+baseId);
      const moreContent=document.getElementById('mc-'+baseId);
      if(!list) return;
      list.innerHTML=''; const visible=[];
      (arr||[]).forEach(it=>{ if(allowItem(it)) visible.push(textOf(it)); });
      const head=visible.slice(0,threshold); const tail=visible.slice(threshold);

      function makeLi(txt){
        const li=document.createElement('li');
        const cb=document.createElement('span'); cb.className='cb'; cb.setAttribute('role','checkbox'); cb.setAttribute('aria-checked','false');
        li.appendChild(cb);
        const w=weightFor(txt,bucket); li.dataset.weight=String(w);
        li.appendChild(document.createTextNode(txt));

        function toggle(){
          const on=cb.classList.toggle('checked'); li.classList.toggle('li-checked',on); cb.setAttribute('aria-checked',on?'true':'false');
          selectedWeights += (on? +w : -w);
          selectedCount  += (on? 1 : -1);
          updateRisk();
          saveSelections();
          try{ document.dispatchEvent(new CustomEvent('bh:symptoms-changed')); }catch(_){}
        }
        li.addEventListener('click',e=>{ if(e.target!==cb) toggle(); });
        cb.addEventListener('click',e=>{ e.stopPropagation(); toggle(); });
        return li;
      }

      head.forEach(t=>list.appendChild(makeLi(t)));
      const dict=I18N[L()];
      if(tail.length && wrap && moreContent){
        wrap.hidden=false; moreContent.innerHTML='';
        const ul=document.createElement('ul'); ul.className='clean'; tail.forEach(t=>ul.appendChild(makeLi(t)));
        moreContent.appendChild(ul);
        const btn=wrap.querySelector('.more-btn'); let open=false;
        btn.textContent = dict.show_more;
        btn.onclick=()=>{ open=!open; moreContent.classList.toggle('open',open); btn.textContent=open?dict.show_less:dict.show_more; };
      }else if(wrap){ wrap.hidden=true; }
    }

    function renderListPlain(baseId,arr,threshold=7){
      const list=document.getElementById(baseId);
      const wrap=document.getElementById('mw-'+baseId);
      const moreContent=document.getElementById('mc-'+baseId);
      if(!list) return;
      list.innerHTML=''; const visible=[];
      (arr||[]).forEach(it=>{ if(allowItem(it)) visible.push(textOf(it)); });
      const head=visible.slice(0,threshold); const tail=visible.slice(threshold);
      function makeLi(txt){ const li=document.createElement('li'); const cb=document.createElement('span'); cb.className='cb'; cb.style.visibility='hidden'; li.appendChild(cb); li.appendChild(document.createTextNode(txt)); return li; }
      head.forEach(t=>list.appendChild(makeLi(t)));
      const dict=I18N[L()];
      if(tail.length && wrap && moreContent){
        wrap.hidden=false; moreContent.innerHTML='';
        const ul=document.createElement('ul'); ul.className='clean'; tail.forEach(t=>ul.appendChild(makeLi(t)));
        moreContent.appendChild(ul);
        const btn=wrap.querySelector('.more-btn'); let open=false;
        btn.textContent = dict.show_more;
        btn.onclick=()=>{ open=!open; moreContent.classList.toggle('open',open); btn.textContent=open?dict.show_less:dict.show_more; };
      }else if(wrap){ wrap.hidden=true; }
    }

    function fillPairs(id,arr){
      const ul=document.getElementById(id); if(!ul) return;
      ul.innerHTML=''; (arr||[]).forEach(x=>{
        const li=document.createElement('li'); const cb=document.createElement('span'); cb.className='cb'; cb.style.visibility='hidden';
        li.appendChild(cb);
        const m=document.createElement('div'); const f=document.createElement('div');
        const isEn=(L()==='en');
        m.innerHTML='<strong>'+(isEn?'Myth:':'Mit:')+'</strong> '+(x.m||'—'); f.innerHTML='<strong>'+(isEn?'Fact:':'Fakt:')+'</strong> '+(x.f||'—');
        ul.appendChild(li); li.appendChild(m); li.appendChild(f);
      });
    }

    function fillFAQ(id,arr){
      const ul=document.getElementById(id); if(!ul) return;
      ul.innerHTML=''; (arr||[]).forEach(x=>{
        const li=document.createElement('li'); const cb=document.createElement('span'); cb.className='cb'; cb.style.visibility='hidden';
        li.appendChild(cb);
        li.innerHTML += '<strong>'+ (x.q|| (L()==='en'?'Question':'Pytanie') ) +'</strong><div style="margin-top:4px;color:#b8c2e0">'+ (x.a|| (L()==='en'?'Answer':'Odpowiedź') ) +'</div>';
        ul.appendChild(li);
      });
    }

    /* Render sekcji */
    renderListInteractive('symp-common', entry.symptoms, 'symptoms');
    renderListInteractive('urgent',      entry.urgent||[],   'urgent', 6);
    renderListPlain('causes',   entry.causes||[]);
    renderListPlain('firstaid', entry.firstaid||[]);
    renderListPlain('meds-otc', entry.otc||[]);
    renderListPlain('meds-rx',  entry.rx||[]);
    renderListPlain('rehab',    entry.rehab||[]);
    fillPairs('myths', entry.myths||[]);
    fillFAQ('faq',     entry.faq||[]);

    selectedWeights=0; selectedCount=0; updateRisk(); showPanel('#s-objawy');

    /* ===== Choroby (beta) ===== */
    function gatherSelectedTexts(){
      const from = (ulId)=> Array.from(document.querySelectorAll('#'+ulId+' li.li-checked'))
                                  .map(li=> li.textContent.trim().toLowerCase());
      return { symp: from('symp-common'), urgent: from('urgent') };
    }

    function computeDx(){
      try{
        const {symp, urgent} = gatherSelectedTexts();
        const picked = (symp.concat(urgent)).map(s=>s.toLowerCase());
        const rules = DX_RULES[CZESC] || [];
        const hits = [];

        const urgentHit = (L()==='en'
          ? ["dyspnea","cyanosis","loss of consciousness","rigid abdomen","bleeding","thunderclap"].some(k=>picked.some(p=>p.includes(k)))
          : ["duszność","sinica","utrata przytomności","twardy brzuch","krwawienie","najgorszy ból"].some(k=>picked.some(p=>p.includes(k)))
        );
        if(urgentHit){
          hits.push({_score:999, name:(L()==='en'?'Alarm signs':'Objawy alarmowe'), advice:(L()==='en'?'Call 112 / ER':'Zadzwoń 112 / SOR'), badge:"sor", ico:"⚠️", _max:1, _match:[]});
        }

        rules.forEach(r=>{
          const keys = (r.keys||[]).map(k=>String(k).toLowerCase());
          const matched = keys.filter(k=> picked.some(p=> p.includes(k)));
          const score = matched.length;
          if(score>0){
            const meta = (L()==='en'? r.en : r.pl);
            hits.push({_score:score, name:meta.name, advice:meta.advice, badge:r.badge, ico: r.badge==='sor'?'⚠️':'🩺', _max: keys.length, _match: matched});
          }
        });

        if(!hits.length){
          hits.push({_score:0, name:(L()==='en'?'Too little data':'Za mało danych'), advice:(L()==='en'?'Select symptoms in “Symptoms” tab':'Zaznacz objawy w zakładce „Objawy”'), badge:"poz", ico:"ℹ️", _max:1, _match:[]});
        }

        hits.sort((a,b)=> b._score - a._score);
        return hits.slice(0,5);
      }catch(_){
        return [{_score:0, name:(L()==='en'?'Temporary error':'Chwilowy błąd'), advice:(L()==='en'?'Refresh page or re-select symptoms.':'Odśwież stronę lub zaznacz objawy ponownie.'), badge:"poz", ico:"ℹ️", _max:1, _match:[]}];
      }
    }

    function renderDx(){
      const ul = document.getElementById('dx-list'); if(!ul) return;
      const items = computeDx();
      ul.innerHTML = '';
      items.forEach(it=>{
        const li = document.createElement('li');
        const cb=document.createElement('span'); cb.className='cb'; cb.style.visibility='hidden';
        const ico=document.createElement('span'); ico.className='dx-ico'; ico.textContent = it.ico || '🩺';

        const text=document.createElement('div');
        const matchTxt = it._match && it._match.length ? ` (${L()==='en'?'hits':'trafienia'}: ${it._match.length})` : '';
        text.innerHTML = `<strong title="${(it._match||[]).join(', ')}">${it.name}${matchTxt}</strong><div style="color:#b8c2e0;margin-top:4px">${it.advice}</div>`;

        const meta=document.createElement('div'); meta.className='dx-meta';
        const confWrap=document.createElement('div'); confWrap.className='conf-wrap';
        const confBar=document.createElement('div'); confBar.className='conf-bar';
        const ratio = it._max ? Math.min(100, Math.round((it._score/it._max)*100)) : (it._score>=999?100:0);
        confBar.style.width = ratio + '%';
        confBar.title = it._match && it._match.length ? ((L()==='en'?'Matching: ':'Pasuje: ')+it._match.join(', ')) : (L()==='en'?'No matches':'Brak dopasowań');
        confWrap.appendChild(confBar);

        const badge=document.createElement('span'); badge.className='dx-badge '+(it.badge==='sor'?'sor':'poz'); badge.textContent = it.badge==='sor'?I18N[L()].badge_sor:I18N[L()].badge_poz;
        const hint=document.createElement('div'); hint.className='dx-match'; hint.textContent = it._match && it._match.length ? ((L()==='en'?'Matching: ':'Pasuje: ')+it._match.join(', ')) : '';

        meta.appendChild(confWrap); meta.appendChild(badge);

        li.appendChild(cb); li.appendChild(ico); li.appendChild(text); li.appendChild(meta);
        if(hint.textContent) li.appendChild(hint);
        ul.appendChild(li);
      });
      activateStep(2);
    }

    /* ===== Lekarze ===== */
    function computeDocs(){
      const {symp, urgent} = gatherSelectedTexts();
      const picked = (symp.concat(urgent)).map(s=>s.toLowerCase());
      const urgentHit = (L()==='en'
        ? ["dyspnea","cyanosis","loss of consciousness","rigid abdomen","bleeding","thunderclap"].some(k=>picked.some(p=>p.includes(k)))
        : ["duszność","sinica","utrata przytomności","twardy brzuch","krwawienie","najgorszy ból"].some(k=>picked.some(p=>p.includes(k)))
      );

      const list = [];
      if(urgentHit){ list.push({name:(L()==='en'?'ER / 112':'SOR / 112'), why:(L()==='en'?'Red flags — urgent care':'Czerwone flagi — pilna pomoc'), badge:"sor", ico:"🚑"}); }

      list.push({name:(L()==='en'?'GP — family doctor':'POZ — lekarz rodzinny'), why:(L()==='en'?'First contact, assessment, referrals':'Pierwszy kontakt, wstępna ocena, skierowania'), badge:"poz", ico:"🩺"});

      const specPL = {
        glowa:["Neurolog","Laryngolog (zatoki)","Okulista (gdy zaburzenia widzenia)"],
        nos:["Laryngolog (otolaryngolog)","Alergolog"],
        oczy:["Okulista"],
        klatka:["Kardiolog","Pulmonolog","Gastroenterolog (refluks)"],
        pluca:["Pulmonolog","Alergolog"],
        serce:["Kardiolog"],
        brzuch:["Gastroenterolog","Chirurg (ostry brzuch)"],
        nerki:["Nefrolog","Urolog"],
        plecy:["Ortopeda","Fizjoterapeuta"],
        biodra:["Ortopeda","Fizjoterapeuta"],
        kolano:["Ortopeda","Fizjoterapeuta"],
        stopy:["Ortopeda","Fizjoterapeuta"],
        skora:["Dermatolog"],
        kaszel:["Pulmonolog","Alergolog"],
        goraczka:["POZ (diagnostyka przyczyny)"],
        zadlawienie:["POZ po incydencie / SOR przy objawach"],
        ciaza:["POZ","Ginekolog/położna"]
      };
      const specEN = {
        glowa:["Neurologist","ENT (sinuses)","Ophthalmologist (if vision issues)"],
        nos:["ENT (otolaryngologist)","Allergist"],
        oczy:["Ophthalmologist"],
        klatka:["Cardiologist","Pulmonologist","Gastroenterologist (reflux)"],
        pluca:["Pulmonologist","Allergist"],
        serce:["Cardiologist"],
        brzuch:["Gastroenterologist","Surgeon (acute abdomen)"],
        nerki:["Nephrologist","Urologist"],
        plecy:["Orthopedist","Physiotherapist"],
        biodra:["Orthopedist","Physiotherapist"],
        kolano:["Orthopedist","Physiotherapist"],
        stopy:["Orthopedist","Physiotherapist"],
        skora:["Dermatologist"],
        kaszel:["Pulmonologist","Allergist"],
        goraczka:["GP (investigate cause)"],
        zadlawienie:["GP after event / ER if symptoms"],
        ciaza:["GP","Obstetrician/midwife"]
      };
      const specByPart = (L()==='en') ? specEN : specPL;
      (specByPart[CZESC]||[]).forEach(s=> list.push({name:s, why:(L()==='en'?'Specialist relevant to the issue':'Specjalista adekwatny do problemu'), badge:"poz", ico:"🏥"}));

      return list;
    }

    function renderDocs(){
      const ul = document.getElementById('docs-list'); if(!ul) return;
      const dict=I18N[L()];
      const items = computeDocs();
      ul.innerHTML = '';
      items.forEach(it=>{
        const li = document.createElement('li');
        const cb=document.createElement('span'); cb.className='cb'; cb.style.visibility='hidden';
        const title = document.createElement('div');
        title.innerHTML = `<strong>${it.name}</strong><div style="color:#b8c2e0;margin-top:4px">${it.why}</div>`;
        const badge=document.createElement('span'); badge.className='doc-badge '+(it.badge==='sor'?'sor':'poz'); badge.textContent = (it.badge==='sor'?dict.badge_sor:dict.badge_doc);

        const prep = document.createElement('a'); prep.href="#"; prep.className="doc-cta"; prep.textContent=dict.prep_visit;
        prep.addEventListener('click', (e)=>{ e.preventDefault(); alert(dict.prep_alert); });

        const ctas = document.createElement('div'); ctas.style.marginTop='6px';
        const sor = document.createElement('a'); sor.className='doc-cta'; sor.href='https://www.google.com/maps/search/' + encodeURIComponent(L()==='en'?'ER near me':'SOR blisko mnie'); sor.target='_blank'; sor.rel='noopener'; sor.textContent=dict.find_er;
        const apteka = document.createElement('a'); apteka.className='doc-cta'; apteka.href='https://www.google.com/maps/search/' + encodeURIComponent(L()==='en'?'24h pharmacy near me':'apteka 24h blisko mnie'); apteka.target='_blank'; apteka.rel='noopener'; apteka.textContent=dict.find_pharmacy;
        ctas.appendChild(sor); ctas.appendChild(document.createTextNode(' ')); ctas.appendChild(apteka);

        const right = document.createElement('div'); right.style.marginLeft='auto'; right.appendChild(badge);
        li.appendChild(cb); li.appendChild(title); li.appendChild(right); li.appendChild(prep); li.appendChild(ctas);
        ul.appendChild(li);
      });
      activateStep(3);
    }

    /* ——— FIX: rebindowanie przycisków „Choroby” / „Lekarze” po zmianie treści hintu ——— */
    function bindHintButtons(){
      const goDx = document.getElementById('dx-open');
      const goDocs = document.getElementById('docs-open');
      if(goDx){
        goDx.onclick = ()=>{ renderDx(); showPanel('#s-dx'); document.querySelector('.tab[data-variant="dx"]')?.classList.remove('tab-attn'); };
      }
      if(goDocs){
        goDocs.onclick = ()=>{ renderDocs(); showPanel('#s-docs'); document.querySelector('.tab[data-variant="docs"]')?.classList.remove('tab-attn'); };
      }
    }

    /* Spięcie interakcji */
    document.addEventListener('bh:symptoms-changed', ()=>{ renderDx(); renderDocs(); updateRisk(); });

    // również przy kliknięciu w zakładki
    document.querySelector('[data-variant="dx"]')?.addEventListener('click', renderDx);
    document.querySelector('[data-variant="docs"]')?.addEventListener('click', renderDocs);

    // Przywrócenie zapamiętanych objawów po wyrenderowaniu list
    window.addEventListener('load', ()=>{ restoreSelections(); bindHintButtons(); });

    /* =========================
       Zastosuj tłumaczenia UI
       ========================= */
    (function applyI18N(){
      const d=I18N[L()];
      // Selektor języka etykieta
      const lbl = document.querySelector('.langpick label');
      if(lbl) lbl.textContent = d.lang_label;

      // Back button
      const back = document.getElementById('bhReturnTop');
      if(back) back.textContent = d.back;

      // Hero texts
      const note = document.querySelector('.hero .hero-note');
      const leg  = document.querySelector('.hero .legend');
      if(note) note.innerHTML = d.hero_note;
      if(leg)  leg.innerHTML  = d.legend;

      // Steps
      const s1=document.getElementById('step-1'), s2=document.getElementById('step-2'), s3=document.getElementById('step-3'), s4=document.getElementById('step-4');
      if(s1){ s1.firstChild.nodeValue = d.steps[0]; s1.querySelector('small').textContent = d.stepsSub[0]; }
      if(s2){ s2.firstChild.nodeValue = d.steps[1]; s2.querySelector('small').textContent = d.stepsSub[1]; }
      if(s3){ s3.firstChild.nodeValue = d.steps[2]; s3.querySelector('small').textContent = d.stepsSub[2]; }
      if(s4){ s4.firstChild.nodeValue = d.steps[3]; s4.querySelector('small').textContent = d.stepsSub[3]; }

      // Tabs
      const map = d.tabs;
      const tab = (v,txt)=>{ const el=document.querySelector(`.tab[data-variant="${v}"]`); if(el) el.textContent = txt; };
      tab('symptoms', map.symptoms); tab('causes', map.causes); tab('firstaid', map.firstaid);
      tab('otc', map.otc); tab('rx', map.rx); tab('rehab', map.rehab);
      tab('myths', map.myths); tab('faq', map.faq); tab('dx', map.dx); tab('docs', map.docs);

      // Headings in cards
      const setTxt=(sel,txt)=>{ const el=document.querySelector(sel); if(el) el.textContent=txt; };
      setTxt('#h-obj', d.symptoms_head);
      setTxt('.subhead', d.urgent_head);
      document.querySelector('#riskbar')?.setAttribute('aria-label', (L()==='en'?'Estimated risk':'Szacowany poziom ryzyka'));
      setTxt('#h-cause', d.h_cause);
      setTxt('#h-aid', d.h_aid);
      setTxt('#h-otc', d.h_otc);
      setTxt('#h-rx', d.h_rx);
      setTxt('#h-rehab', d.h_rehab);
      setTxt('#h-mity', d.h_myths);
      setTxt('#h-faq', d.h_faq);
      setTxt('#h-dx', d.h_dx);
      setTxt('#h-docs', d.h_docs);

      // Urgent strip + CTA
      const strip = document.getElementById('urgent-strip');
      if(strip){
        const tel = document.createElement('a');
        tel.className='cta'; tel.id='cta-112'; tel.href='tel:112'; tel.setAttribute('aria-label', d.call_112);
        tel.textContent = d.call_112;
        strip.innerHTML = d.urgent_strip + ' ';
        strip.appendChild(tel);
      }

      // Hint box — UWAGA: po modyfikacji innerHTML rebindowanie przycisków
      const hint = document.getElementById('dx-hint');
      if(hint){
        hint.innerHTML = `${d.hint} <button type="button" id="dx-open">${d.hint_btn_dx}</button> <button type="button" id="docs-open">${d.hint_btn_docs}</button>`;
        bindHintButtons(); // <-- FIX: przywróć działanie guzików
      }

      // Risk label base text
      const riskLabelWrap = document.querySelector('.risk-mini small');
      if(riskLabelWrap){ riskLabelWrap.innerHTML = `${d.risk} <span id="risk-label">${d.risk_low}</span>`; }

      // Breadcrumbs „Szczegóły/Details”
      const crumbDetails = document.getElementById('crumb-label');
      if(crumbDetails) crumbDetails.textContent = d.crumbs_details;

      // Statystyki karta
      const statH = document.querySelector('#statystyki h3');
      const statLis = document.querySelectorAll('#statystyki ul.checklist li');
      if(statH) statH.textContent = d.stats_h;
      if(statLis && statLis.length===d.stats.length){
        d.stats.forEach((txt,i)=>{ statLis[i].textContent = txt; });
      }
    })();

    /* Particles (bez zmian funkcjonalnych) */
    (function particles(){
      const c=document.getElementById('bh-particles'); if(!c) return;
      const prefersReduced=window.matchMedia?.('(prefers-reduced-motion: reduce)')?.matches;
      const dpr=Math.min(2,window.devicePixelRatio||1);
      const ctx=c.getContext('2d'); let W,H,dots=[];
      function targetCount(){ const t=Math.floor((innerWidth*innerHeight)/12000); return Math.max(90,Math.min(220,t)); }
      function resize(){
        W=c.width=Math.floor(innerWidth*dpr); H=c.height=Math.floor(innerHeight*dpr);
        c.style.width=innerWidth+'px'; c.style.height=innerHeight+'px';
        const N=targetCount(); dots=Array.from({length:N},()=>({x:Math.random()*W,y:Math.random()*H,vx:(Math.random()-.5)*.18*dpr,vy:(Math.random()-.5)*.18*dpr,r:(Math.random()*1.7+0.9)*dpr,a:Math.random()*.6+.25}));
      }
      function step(){
        ctx.clearRect(0,0,W,H);
        for(const p of dots){
          p.x+=p.vx; p.y+=p.vy;
          if(p.x<0||p.x>W) p.vx*=-1;
          if(p.y<0||p.y>H) p.vy*=-1;
          ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
          const g=ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*3.2);
          g.addColorStop(0,`rgba(164,107,255,${0.26*p.a})`); g.addColorStop(1,`rgba(94,234,212,0)`); ctx.fillStyle=g; ctx.fill();
        }
        if(!prefersReduced) requestAnimationFrame(step);
      }
      addEventListener('resize',resize,{passive:true}); resize(); step();
    })();
  </script>

  <!-- Usunięty stary translator: brak <script src="/assets/js/translator-unified.js"> -->
</body>
</html>
