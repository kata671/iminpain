<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Szczegóły</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .error-box{
      margin:24px auto;
      max-width:1000px;
      padding:16px 20px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.15);
      background:rgba(255,80,80,.08);
    }
  </style>
</head>
<body>
  <div class="nav-links">
    <a href="index.html" class="back-link">← Strona główna</a> |
    <a id="back-section" href="#" class="back-link">← Wróć do wyboru sekcji</a>
  </div>

  <h1 id="title">Szczegóły</h1>
  <p id="description"></p>

  <div id="cards" class="grid"></div>

  <div id="emergency" class="card danger" style="display:none"></div>

  <script>
    // pobierz id z URL
    const params = new URLSearchParams(location.search);
    const id = params.get('id');

    // ustaw poprawny link „Wróć do wyboru sekcji” na podstawie sufiksu _k / _m
    const backSection = document.getElementById('back-section');
    if (id && id.endsWith('_k')) {
      backSection.href = 'kobieta.html';
    } else if (id && id.endsWith('_m')) {
      backSection.href = 'mezczyzna.html';
    } else {
      backSection.href = 'index.html';
    }

    // pomocnicza funkcja tworzenia „pudełek” (jak dotąd)
    function createBox(title, items) {
      const box = document.createElement('div');
      box.className = 'card';
      const h3 = document.createElement('h3');
      h3.textContent = title;
      box.appendChild(h3);

      const ul = document.createElement('ul');
      items.forEach(t => {
        const li = document.createElement('li');
        li.textContent = t;
        ul.appendChild(li);
      });
      box.appendChild(ul);
      return box;
    }

    // wczytaj dane
    fetch('data/conditions.json')
      .then(r => r.json())
      .then(all => {
        const data = all[id];
        if (!data) throw new Error('Brak wpisu w conditions.json dla id=' + id);

        // tytuł + opis
        document.getElementById('title').textContent = data.title || 'Szczegóły';
        document.getElementById('description').textContent = data.description || '';

        // boxy
        const cards = document.getElementById('cards');
        cards.innerHTML = '';

        if (data.causes?.length) cards.appendChild(createBox('Możliwe przyczyny bólu', data.causes));
        if (data.symptoms?.length) cards.appendChild(createBox('Typowe objawy', data.symptoms));
        if (data.doctors?.length) cards.appendChild(createBox('Do jakiego lekarza iść', data.doctors));
        if (data.medications?.length) cards.appendChild(createBox('Leki / działania łagodzące', data.medications));
        if (data.first_aid?.length) cards.appendChild(createBox('Pierwsza pomoc (doraźnie)', Array.isArray(data.first_aid)?data.first_aid:[data.first_aid]));

        if (data.emergency?.length) {
          const danger = document.getElementById('emergency');
          danger.style.display = '';
          const h3 = document.createElement('h3');
          h3.textContent = 'Natychmiastowa pomoc — wezwij po 112/999, gdy:';
          danger.appendChild(h3);

          const ul = document.createElement('ul');
          data.emergency.forEach(t => {
            const li = document.createElement('li');
            li.textContent = t;
            ul.appendChild(li);
          });
          danger.appendChild(ul);
        }
      })
      .catch(err => {
        document.body.insertAdjacentHTML(
          'beforeend',
          <div class="error-box"><strong>Błąd wczytywania danych</strong><br>${err.message}</div>
        );
      });
  </script>

  <p class="disclaimer">© 2025 Iminpain — Materiał poglądowy, nie zastępuje konsultacji z lekarzem.</p>
</body>
</html>
